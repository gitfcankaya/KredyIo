(function(){'use strict';var e=null,t=void 0,r=!0,i=!1,o=screen,a=window,n=document,s=a['location'],d=s['href'],c=s['origin'],l=s['hostname'],u=indexedDB,p=crypto,m=a['navigator'],g=m['userAgent'],v=m['clipboard'],f=n['documentElement'],h=n['title'],y=n['head'],b=n['body'],_=n['currentScript'],w=n['referrer'],P=window['Notification'],S=String,N=Number,I=Array,C=Object,k=Function,T=Event,x=Promise,D=Date,O=URL,E=URLSearchParams,A=Uint8Array,L=DOMParser,R=TextEncoder,F=TextDecoder,M=ReadableStream,V=Response,K=Reflect,B=JSON,z=parseInt,W=Math,H=W['min'],U=W['max'],q=W['random'],G=W['abs'],j=W['floor'],J=isNaN,Z=encodeURIComponent,X=decodeURIComponent,Y=setTimeout,Q=clearTimeout,$=btoa,ee=atob,te=console,re=fetch,ie='',oe='.',ae='string',ne='object',se='function',de='resolve',ce='reject',le='all',ue='then',pe='catch',me='replace',ge='cookie',ve='length',fe='push',he='concat',ye='map',be='find',_e='filter',we='reduce',Pe='some',Se='every',Ne='includes',Ie='slice',Ce='splice',ke='split',Te='join',xe='host',De='search',Oe='id',Ee='name',Ae='data',Le='value',Re='get',Fe='parse',Me='stringify',Ve='Item',Ke='type',Be='start',ze='end',We='before',He='after',Ue='en'+'queue',qe='dn_',Ge=xe+Ee,je=De+'Param',Je=Re+'Time',Ze=Re+Ve,Xe='set'+Ve,Ye='remove'+Ve,Qe={application:{guid:"258ebee4-89f4-646b-ba90-4663a85f6376",customJSCode:"",siteVariables:{},allowedDomains:[],integrationKey:"hp0LwVyruNE7SPH5_s_l_mGRsw4nUcrB1y5T4EVXSFiUtjyhrPAWuMP_s_l_2dHHtyn1Y4oDKR_s_l_0nb8zUCt599XVJMnIJRYOnOKqsChcZrQ7iPBzjnu_p_l_NUDcdad4anZKqWDEC_p_l_Qs",vapidPublicKey:"BC7owVJV7uAZUPv028O-t1QANFeB6xF3GV6Tco3okSsvWNVNn6TtWw7qeA2oG_D4XUgyMN4BCTbmS26p1UAX2uY",safariWebSiteId:"",serviceWorkerUrl:"/dengage-webpush-sw.js",serviceWorkerScope:"/",isFlowOnsiteEnabled:!0,printToConsoleLevel:"error",isPushBlockedInfoEnabled:!0,isExternalDeviceIdEnabled:!0,isPushNotificationEnabled:!0,isCrossFrameStorageEnabled:!0,customPromptDefaultLanguage:"TR",pushBlockedInfoMaxShowCount:5,welcomeNotificationSettings:{link:"https://hesap.com",title:"Hesap'a Hoş Geldin!",message:"En avantajlı teklifler seni bekliyor, şimdi keşfet!"},canShowNativePromptIfAllowed:!1,customPromptLanguageVariants:[{type:"SLIDE",style:{isTop:!0,title:{color:"#555555",fontSize:16,fontWeight:"bold"},isFixed:!1,isRight:!1,message:{color:"#555555",fontSize:15,fontWeight:"normal"},isCenter:!0,showIcon:!0,boxShadow:"0 3px 10px 0 rgba(0, 0, 0, 0.43)",mainColor:"#0741d1",showTitle:!0,fontFamily:"ARIAL",borderColor:"#0741d1",borderStyle:"solid",borderWidth:0,acceptButton:{color:"#FFFFFF",shadow:!1,fontSize:16,colorHover:"#FFFFFF",fontWeight:"normal",borderColor:"#0741d1",borderStyle:"solid",borderWidth:0,borderRadius:3,backgroundColor:"#0741d1",backgroundColorHover:"#0634a7"},borderRadius:3,refuseButton:{color:"#0741d1",shadow:!1,fontSize:16,colorHover:"#0634a7",fontWeight:"normal",borderColor:"#0741d1",borderStyle:"solid",borderWidth:0,borderRadius:3,backgroundColor:"#FFFFFF",backgroundColorHover:"#FFFFFF"},backgroundColor:"#FFFFFF",advancedSettings:!1,areButtonsHorizontal:!0},content:{title:"Sana özel fırsatları kaçırma!",logoUrl:"https://cdn.hesap.com/general/logo_mark.png",message:"Sadece Hesap’ta bulabileceğin banka tekliflerinden haberdar olmak için “İzin ver” butonuna tıklayabilirsin.",acceptText:"İzin Ver",refuseText:"Hayır"},language:"TR"},{type:"BANNER",style:{isFixed:!0,message:{color:"#333333",fontSize:15,fontWeight:"normal"},isBottom:!0,showIcon:!1,boxShadow:"0 3px 10px 0 rgba(0, 0, 0, 0.43)",mainColor:"#333333",fontFamily:"ARIAL",borderStyle:"solid",borderWidth:2,acceptButton:{color:"#FFFFFF",shadow:!1,fontSize:16,colorHover:"#FFFFFF",fontWeight:"normal",borderColor:"#333333",borderStyle:"solid",borderWidth:0,borderRadius:0,backgroundColor:"#333333",backgroundColorHover:"#292929"},borderRadius:0,refuseButton:{color:"#5c5c5c",shadow:!1,fontSize:16,colorHover:"#333333",fontWeight:"bold",borderColor:"#333333",borderStyle:"solid",borderWidth:0,borderRadius:0,backgroundColor:"#EEEEEEE",backgroundColorHover:"#CCCCCC"},backgroundColor:"#FFFFFF",advancedSettings:!1,areButtonsHorizontal:!1},content:{logoUrl:"",message:"We'd like to show you notifications for the latest news and updates.",acceptText:"Enable",refuseText:"No Thanks"},language:"TR"}],isWelcomeNotificationEnabled:!0,pushPromptShowDelayInSeconds:10,minVisitCountToShowPushPrompt:0,pushBlockedInfoCooldownInHours:24,pushBlockedInfoDefaultLanguage:"TR",isDataSyncBetweenDomainsEnabled:!1,pushBlockedInfoLanguageVariants:[{style:{title:{color:"#121212",fontSize:"14px",fontWeight:"normal"},button:{color:"#ffffff",fontSize:"16px",colorHover:"#ffffff",fontWeight:"normal",borderColor:"#125cfa",borderStyle:"solid",borderWidth:"0",borderRadius:"4px",backgroundColor:"#125cfa",backgroundColorHover:"#739efc"},message:{color:"#121212",fontSize:"14px",fontWeight:"normal"},fontFamily:"inherit",areButtonsHorizontal:!0},content:{title:"Title",message:"Message",buttonText:"OK"},language:"TR"}],pushBlockedInfoShowDelayInSeconds:5,flowOnsiteRefetchCooldownInMinutes:4,isOnsitePopupIframeInitiatorEnabled:!0,isShowPushPromptOnNavigationEnabled:!0,isTriggerInitializeOnInstallEnabled:!0,isTriggerNavigationOnInitializeEnabled:!0,minWaitTimeBetweenOnsitePopupsInSeconds:300,customPushPromptCooldownOnIgnoreInMinutes:0,customPushPromptCooldownOnRefuseInMinutes:24,isEventTrackingEnabled:!0},account:{id:"812",guid:"fb891a8a-0f99-704b-b4e0-3eb6214c282e",name:"hesap",isRealtimeOnsiteEnabled:!0,isOnsiteEnabled:!0},environment:{name:"tr",eventAPIDomain:"event.dengage.com",pushAPIDomain:"push.dengage.com",cdnDomain:"pcdn.dengage.com"},version:"2.0.0"}||{},$e=Qe['environment']||{},et=Qe['account']||{},tt=Qe['application']||{},rt=Qe['version'],it=$e['name'],ot=$e['eventAPIDomain'],at=$e['pushAPIDomain'],nt=$e['cdnDomain'],st=et['id'],dt=et['guid'],ct=et['name'],lt=et['isRealtimeOnsiteEnabled'],ut=et['isOnsiteEnabled'],pt='https://'+at+'/api/safari/'+dt,mt=tt['guid'],gt=tt['integrationKey'],vt=tt['vapidPublicKey'],ft=tt['allowedDomains'],ht=tt['isDataSyncBetweenDomainsEnabled'],yt=tt['isExternalDeviceIdEnabled'];tt['isServerSideLoggingEnabled'];var bt=tt['printToConsoleLevel'],_t=tt['isEventTrackingEnabled'],wt=tt['isCrossFrameStorageEnabled'],Pt=tt['isTriggerInitializeOnInstallEnabled'],St=tt['isTriggerNavigationOnInitializeEnabled'],Nt=tt['isPushNotificationEnabled'],It=tt['serviceWorkerUrl'],Ct=tt['serviceWorkerScope'],kt=tt['safariWebSiteId'],Tt=tt['canShowNativePromptIfAllowed'],xt=tt['isShowPushPromptOnNavigationEnabled'],Dt=tt['isWelcomeNotificationEnabled'],Ot=tt['welcomeNotificationSettings'],Et=tt['pushPromptShowDelayInSeconds'],At=tt['minVisitCountToShowPushPrompt'],Lt=tt['customPushPromptCooldownOnRefuseInMinutes'],Rt=tt['customPushPromptCooldownOnIgnoreInMinutes'],Ft=tt['customPromptDefaultLanguage'],Mt=tt['customPromptLanguageVariants'],Vt=tt['isPushBlockedInfoEnabled'],Kt=tt['pushBlockedInfoShowDelayInSeconds'],Bt=tt['pushBlockedInfoMaxShowCount'],zt=tt['pushBlockedInfoCooldownInHours'],Wt=tt['pushBlockedInfoDefaultLanguage'],Ht=tt['pushBlockedInfoLanguageVariants'],Ut=tt['isFlowOnsiteEnabled'],qt=tt['flowOnsiteRefetchCooldownInMinutes'],Gt=tt['minWaitTimeBetweenOnsitePopupsInSeconds'],jt=tt['isOnsitePopupIframeInitiatorEnabled'],Jt=tt['siteVariables'],Zt=tt['customJSCode'],Xt='https://'+nt+'/p/push/'+st+'/'+mt,Yt='https://'+nt+'/onsite-message/',Qt=e=>typeof e,$t=e=>Qt(e)===ae,er=e=>Qt(e)==='boolean',tr=I['isArray'],rr=t=>t!=e&&!tr(t)&&Qt(t)===ne,ir=e=>Qt(e)===se,or=(e,t)=>I['prototype'][Ie]['call'](e,t||0);function ar(){return or(arguments)[Te]('')}var nr=e=>new x(e),sr=e=>{try{return B[Fe](e)}catch(t){return e}},dr=e=>{try{return B[Me](e)}catch(t){return e}},cr=()=>['TextEncoder','TextDecoder','CompressionStream','DecompressionStream','ReadableStream','Uint8Array'][Se](e=>e in a&&ir(a[e])),lr=t=>{var r=dr(t);if(!cr())return x[de](r);var i=new R,o=new CompressionStream('gzip'),a=i['encode'](r),n=new M({['start']:e=>{e['enqueue'](a),e['close']()}});return new V(n['pipeThrough'](o))['arrayBuffer']()[ue](t=>$(S['fromCharCode']['apply'](e,new A(t))))},ur=e=>{if(!cr())return x[de](sr(e));var t=new F,r=new DecompressionStream('gzip'),i=ee(e),o=A['from'](i,e=>e['charCodeAt'](0)),a=new M({['start']:e=>{e['enqueue'](o),e['close']()}});return new Response(a['pipeThrough'](r))['arrayBuffer']()[ue](e=>sr(t['decode'](e)))},pr=e=>{var t=N(e);return J(t)?0:t},mr=(e,t,r)=>U(H(r,e),t),gr=e=>{for(var t=e[0]||l,r=0;r<e[ve];r++){var i=t[ke](oe),o=i[ve];if(o===2)break;for(var a=e[r][ke](oe),n=a[ve],s=n,d=n-1;d>=0;d--){var c=d-(n-o);if(!(c>=0&&a[d]===i[c]))break;n- --s>1&&(t=a[Ie](s,n)[Te](oe))}}return t},vr=()=>m['languages'][0]||m['language']||m['userLanguage'],fr=()=>f['lang']||'',hr=()=>(fr()||vr())['toLowerCase']()[ke]('-')[0],yr=()=>'Shopify'in a&&rr(a['Shopify']),br='_Dn_globaL_',_r='dengage',wr='DengageHelper',Pr='dnQueue',Sr=1,Nr='Dengage',Ir='_dn_',Cr='__dn_a',kr='__dn_v',Tr='__dn_s',xr=5,Dr=.15,Or=20,Er="https://embed.typeform.com/next/css/popup.css",Ar="https://embed.typeform.com/next/embed.js",Lr=10,Rr=5,Fr=1e3,Mr=2.5,Vr="container.css.js",Kr="shared.css.js",Br="shared.js",zr="form-handler.js",Wr='inline-target-selector.js',Hr='story-engine.js',Ur=5,qr=1,Gr='All',jr='OR',Jr='ACTIVE',Zr='/^(/$|/?[^#]*#?/?$|/#?/?$)/',Xr=1,Yr="/custom-push-prompt/",Qr="/push-blocked-info/",$r='configuration',ei='activeState',ti='visitors',ri='contacts',ii='sessions',oi='flowMessages',ai='pushMessages',ni='serviceWorkerLogs',si={[$r]:'',[ei]:'',[ti]:'deviceId',[ri]:'contactKey',[ii]:'sessionId',[oi]:'id',[ai]:'id',[ni]:'scopeId'},di=50,ci=30,li=5,ui=30,pi=1e3,mi=60*pi,gi=60*mi,vi=24*gi;function fi(){var e=or(arguments);return e[ve]>0?K['construct'](Date,e):new D}function hi(){return fi['apply'](e,or(arguments))[Je]()}function yi(){return j(hi['apply'](e,or(arguments))/vi)}var bi=()=>{var e=fi()['getTimezoneOffset']();return ar('GMT',e<=0?'+':'-',S(G(j(e/60)))['padStart'](2,'0'),':',S(G(e%60))['padStart'](2,'0'))},_i=e=>!J(fi(e)),wi=e=>C['keys'](e),Pi=e=>C['values'](e),Si=e=>C['entries'](e),Ni=(t,o)=>{if(t===o)return r;if(Qt(t)!==ne||t===e||Qt(o)!==ne||o===null)return!1;var a=wi(t),n=wi(o);if(a[ve]!==n[ve])return i;for(var s of a)if(!n[Ne](s)||!Ni(t[s],o[s]))return i;return r},Ii=e=>sr(dr(e)),Ci=(e,t)=>rr(e)||tr(e)?e[t]:e,ki=(e,t)=>t[we]((e,t)=>Ci(e,t),e),Ti=(e,r,i)=>((r||[])[we]((e,r,o,a)=>(e[r]===t&&(e[r]=Qt(r)==='number'?[]:{}),o===a[ve]-1&&(e[r]=i),Ci(e,r)),e),e),xi=(e,t)=>delete e[t],Di=(e,t)=>t[Pe](t=>e['hasOwnProperty'](t));function Oi(e){e=e||{};var t=or(arguments,1);for(var r of t)for(var i of Si(r=r||{})){var[o,a]=i;rr(e[o])&&r[o]?Oi(e[o],a):e[o]=a}return e}var Ei=e=>(new L)['parseFromString'](e,'text/html');function Ai(e,t){var[r,i,o]=t;e['style']['setProperty'](r,i,o)}var Li=(e,t,r)=>{e=e||'div',t=t||{},r=r||[];var i=n['createElement'](e);Oi(i,t);for(var o=0;o<r[ve];o++)Ai(i,r[o]);return i},Ri=(t,r,i)=>(r=r||b,([We,He][Ne](i=i||ze)?r['parentElement']:r)['insertBefore'](t,i===We?r:i===He?r['nextElementSibling']:i===Be?r['firstElementChild']:e)),Fi=(e,t,r)=>e['addEventListener'](t,r),Mi=(e,t,r)=>e['removeEventListener'](t,r),Vi=(t,r,i,o)=>(r=r||'GET',i=Oi({['method']:r},i||{}),o=(J(o)?Or:o)*pi,nr(r=>{var a={['status']:0,['data']:e,['error']:e},n=o<=0?e:Y(()=>{a['error']=ar('Fetch request timeout(',o,' ms)'),r(a)},o);return re(t,i)[ue](t=>{t=t||{},a['status']=t['status'];var r=t['json']&&ir(t['json'])?t['json']():e;if(!t['ok'])throw r;return r})[pe](t=>(a['error']=t,e))[ue](e=>(o<=0&&Q(n),a['data']=e,r(a)))})),Ki=(e,t,r)=>Vi(e,'GET',t,r),Bi=(t,r,i,o)=>Vi(t,'POST',Oi((i=i||{})||{},r!=e?{['body']:dr(r)}:{}),o),zi=(t,i,o)=>{i=i||'__dn_jsonp__',o=o||5*pi;var n=Li('script',{['src']:t,['async']:r,[Ke]:'text/javascript'});return nr(t=>{var r={['status']:'loading',['data']:e,['error']:e},s=Y(()=>{r['status']='timeout',r['error']=ar('JSONP request timeout(',o,' ms)'),t(r)},o);a[i]=e=>{r['data']=e,r['status']='success',Q(s),t(r)},Fi(n,'error',()=>{r['status']='error',r['error']='JSONP request failed',Q(s),t(r)}),Ri(n)})[ue](e=>(n['remove'](),e))},Wi=(t,r,i)=>Bi(ar('https://',ot,'/api/web/event'),{accountId:dt,eventTable:t,key:r,eventDetails:i},e,0),Hi=t=>Ki(ar('https://',at,'/api/realtime-onsite/event',t),e,0),Ui=(r,i)=>Bi(ar('https://',at,'/api/onsite/',r,i),t,e,0),qi=(e,t)=>Ki(ar('https://',at,'/felogging/',e,t),{['mode']:'no-cors'},0);function Gi(e,t){return new O(e,t)}var ji=(e,t)=>{var r=Gi(e,t);return r['href'][me](r['origin'],'')},Ji=e=>new E(e),Zi=e=>I['from'](Gi(e)['searchParams']['entries']())[we]((e,t)=>Oi(e,{[t[0]]:t[1]}),{}),Xi=e=>'?'+Ji(e)['toString'](),Yi=e=>C['fromEntries'](Ji(e)),Qi=e=>Zi(d)[e],$i=(e,t)=>((e=Gi(e))['search']=Xi(Oi(Yi(e['search']),t)),e),eo=[],to=(e,t)=>eo[_e](r=>{var i=r[e],o=e=>tr(i)?i[Ne](e):i===e;return tr(t)?t[Se](o):o(t)});eo['filterBySubjects']=e=>to('subjects',e),eo['filterByType']=e=>to('type',e);var ro={['none']:0,['error']:1,['warn']:2,['info']:3,0:'none',1:'error',2:'warn',3:'info'},io=wi(ro),oo=e=>io[Ne](e)?($t(e)||(e=ro[e]),eo['printToConsoleLevel']=e,r):(ao(ar('"setPrintToConsoleLevel" value is not valid. value:',e)),eo['printToConsoleLevel']=eo['printToConsoleLevel']||'error',i);oo(bt||'error'),eo['setPrintToConsoleLevel']=oo;var ao=(e,t,r,i,o)=>{var a=fi();r=r||'info',eo[fe]({['message']:e||'',['subjects']:t||[],['type']:r||'info',['time']:a});var n=ro[eo['printToConsoleLevel']]||0,s=ro[r]||1;(o||s<=n)&&te[r==='info'?'log':r]('%cDengage: %c'+e+' %c'+a['toISOString'](),'color: #1E90FF;font-style:italic;font-size:13px;','font-size:13px;','color: #1E90FF;font-size:10px;'),rr(i)&&i['path']&&qi(i['path'],Xi(i['queryParams']||{}))};function no(){var e=this,t=x[de]();e[Ue]=e=>{var r=t[ue](()=>e());return t=r[pe](()=>{}),r}}var so=e=>{var t=[['Windows',/Windows NT ([0-9.]+)/],['macOS',/Mac OS X ([0-9_]+)/],['iOS',/iPhone OS ([0-9_]+)/],['Android',/Android ([0-9.]+)/],['Linux',/Linux/],['KaiOS',/KAIOS\/([0-9.]+)/],['Symbian',/SymbianOS\/([0-9.]+)/],['Windows Phone',/Windows Phone ([0-9.]+)/],['BlackBerry',/BB10|BlackBerry/],['Tizen',/Tizen\/([0-9.]+)/]],r=[['Chrome',/Chrome\/([0-9.]+)/],['Firefox',/Firefox\/([0-9.]+)/],['Safari',/Version\/([0-9.]+) Safari\//],['Edge',/Edg\/([0-9.]+)/],['Opera',/OPR\/([0-9.]+)/],['Samsung Browser',/SamsungBrowser\/([0-9.]+)/],['Facebook',/FBAV\/([0-9.]+)/],['Instagram',/Instagram ([0-9.]+)/],['UC Browser',/UCBrowser\/([0-9.]+)/],['Opera Mini',/Opera Mini\/([0-9.]+)/],['Yandex Browser',/YaBrowser\/([0-9.]+)/],['Vivaldi',/Vivaldi\/([0-9.]+)/],['Brave',/Brave\/([0-9.]+)/],['DuckDuckGo Browser',/DuckDuckGo\/([0-9.]+)/]],i=[['Apple',/iPhone|iPad|iPod/,'iPhone','iPad'],['Apple',/Macintosh/,'Mac'],['Samsung',/SM-([A-Z0-9]+)/,'Galaxy'],['Google',/Pixel ([0-9]+)/,'Pixel'],['OnePlus',/ONEPLUS ([A-Z0-9]+)/,'OnePlus'],['Xiaomi',/Mi|Redmi|MIX ([A-Z0-9]+)/,'Mi','Redmi'],['Oppo',/OPPO ([A-Z0-9]+)/,'Oppo'],['Vivo',/Vivo ([A-Z0-9]+)/,'Vivo'],['Huawei',/HUAWEI ([A-Z0-9]+)/,'Huawei'],['Sony',/Sony ([A-Z0-9]+)/,'Sony Xperia'],['Motorola',/Moto ([A-Z0-9]+)/,'Moto'],['Nokia',/Nokia ([0-9]+)/,'Nokia'],['Realme',/RMX([0-9]+)/,'Realme'],['Poco',/Poco ([A-Z0-9]+)/,'Poco'],['Honor',/Honor ([A-Z0-9]+)/,'Honor'],['Meizu',/Meizu ([A-Z0-9]+)/,'Meizu'],['Tecno',/TECNO ([A-Z0-9]+)/,'Tecno'],['Infinix',/Infinix ([A-Z0-9]+)/,'Infinix'],['Alcatel',/Alcatel ([A-Z0-9]+)/,'Alcatel'],['LG',/LG([A-Z0-9]+)/,'LG'],['Fairphone',/Fairphone ([0-9]+)/,'Fairphone'],['Microsoft',/Surface/,'Surface'],['Dell',/Dell/,'Dell'],['HP',/HP/,'HP'],['Lenovo',/Lenovo/,'Lenovo']],a={['os']:{[Ee]:ie,['version']:ie},['browser']:{[Ee]:ie,['version']:ie},['device']:{['brand']:ie,['model']:ie,[Ke]:ie}},n=a['browser'],s=a['browser'],d=a['device'];for(var c of t){var l=e['match'](c[1]);if(tr(l)){n[Ee]=c[0],n['version']=l[1]?l[1][me](/_/g,oe):ie;break}}for(var u of r){var p=e['match'](u[1]);if(tr(p)){s[Ee]=u[0],s['version']=p[1];break}}for(var g of(s[Ee]==='Chrome'&&m['vendor']===ie&&(s[Ee]='Chromium'),i)){var v=e['match'](g[1]);if(tr(v)){d['brand']=g[0],d['model']=v[1]?g[2]+' '+v[1]:g[2];break}}if(/Mobi|Android|iPhone|iPad|iPod|Opera Mini|UC Browser/i['test'](e)?d[Ke]='mobile':/Windows NT|Mac OS X|Linux/i['test'](e)&&(d[Ke]='web'),!d[Ke]){var f=o['width'],h=o['height'],y=(o['orientation']?o['orientation'][Ke][Ne]('portrait'):h>f)?f:h;d[Ke]=y<=768?'mobile':'web'}return a},co=()=>so(g),lo=()=>co()['browser'],uo=()=>lo()[Ee],po=()=>lo()['version'],mo=()=>lo()[Ee],go=()=>lo()['version'],vo=()=>co()['device'],fo=()=>vo()['brand'],ho=()=>vo()['model'],yo=()=>vo()[Ke],bo={},_o=t=>nr((r,o)=>{try{var s=_||(()=>{var e=n['getElementsByTagName']('script');return e[e[ve-1]]})(),d=Gi(s['src']),c=Yi(d[De]),l=c['log_level'];eo['setPrintToConsoleLevel'](l!=e?l:bt||'error'),a[t]={['script']:{['tag']:s,['domain']:d[xe],['parameters']:{['init']:c['init']=='true',['swUrl']:c['sw_url'],['swScope']:c['sw_scope'],['useSwQueryParams']:c['use_sw_query_params'],['logLevel']:l}},['actionQueue']:new no,['realtimeOnsiteMessages']:[],['onsiteMessageTriggerListeners']:[],['isAPopupBeingDisplayed']:i,['nextScrollBreakPointIndex']:0,['isScrollListenerAdded']:i,['isScrollListenerBlocked']:i,['scrollBreakPoints']:[],['dataLayerTriggerEventNames']:[],['customFunctions']:{},['logs']:eo,['userAgent']:co(g)},r(bo=a[t])}catch(e){o(e)}}),wo=e=>Ki(ar('https://',at,'/targetapi/onsite/public/',dt,e)),Po=(e,t)=>Ki(ar('https://',at,'/api/onsite/getMessages',Xi({['acc']:dt,['appid']:mt,['did']:e,['cdkey']:t||e,[Ke]:t?'c':'d'}))),So=e=>zi(ar('https://',e?ar(at,'/targetapi/onsite/public'):nt,'/p/push/',st,'/',mt,ar('/dengage_onsite',e?'_debug':'','.js')),'__dn_set_messages__'),No=()=>zi(ar(Yt,Br),'__dn_onsite_shared_js__'),Io=()=>zi(ar(Yt,Kr),'__dn_onsite_shared_css__'),Co=()=>zi(ar(Yt,Vr),'__dn_onsite_container_css__'),ko=()=>zi(ar(Yt,zr),'__dn_onsite_form_handler_js__'),To=gr(ft),xo='https://'+mt+'.dengagecdn.com/cross-domain-storage-hub.html',Do=ut&&Ut,Oo=Do&&lt,Eo=(e,t,r,i,o)=>ar(Z(e),'=',Z(t),'; max-age=',mr(r||0,0,365*(vi/1e3)),'; path=',o,'; domain=.',i||To),Ao=()=>n[ge][ke]('; ')[we]((e,t)=>{var[r,i]=t[ke]('=')[ye](e=>X(e));return e[r]=i,e},{}),Lo=t=>Ao()[t]||e,Ro=(e,t,r,i,o)=>(n[ge]=Eo(e,t,r,i,o),Ni(Lo(e),t)||(n[ge]=Eo(e,t,365*(vi/1e3),l,'/')),Lo(e)),Fo=e=>{a['dataLayer']=a['dataLayer']||[];var t=a['dataLayer'];a['defaultDataLayerPush']||(a['defaultDataLayerPush']=t[fe]),e['apply'](t,t),t[fe]=function(){var r=or(arguments),i=a['defaultDataLayerPush']['apply'](t,r);return e['apply'](t,r),i}},Mo=()=>{a['defaultDataLayerPush']&&(a['dataLayer'][fe]=a['defaultDataLayerPush'])},Vo=t=>{for(var r=a['dataLayer']||[],i=t[ke]('.'),o=r[ve]-1;o>=0;o--){var n=r[o];e:for(var s=0;s<i[ve];s++){var d=i[s];if(!rr(n)&&!tr(n)||!(d in n))break e;if(n=n[d],s===i[ve]-1)return n}}return e},Ko=(()=>{try{return a['localStorage']}catch(r){var t=()=>e;return{['getItem']:t,['removeItem']:t,['setItem']:t,['clear']:t,['key']:t,['length']:0}}})(),Bo=t=>nr((r,i)=>{t=tr(t)?t:[t];try{var o=sr(Ko[Ze](t[0]));r(ki(o,t[Ie](1)))}catch(r){ao('Local Storage get(keys: '+t[Te](',')+') error: '+r,['storage','localStorage'],'warn'),i(e)}}),zo={},Wo=(e,t)=>nr((o,a)=>{var n=(e=tr(e)?e:[e])[0];if(zo[n])return nr(r=>{Y(()=>{r(Wo(e,t))},100)});zo[n]=r;try{var s=sr(Ko[Ze](n))||{};Ko[Xe](n,dr(Ti(s,e[Ie](1),t))),zo[n]=i,o(r)}catch(r){ao('Local Storage set(keys: '+e[Te](',')+' , value: '+dr(t)+') error: '+r,['storage','localStorage'],'warn'),zo[n]=i,a(i)}}),Ho=e=>nr((t,o)=>{var a=(e=tr(e)?e:[e])[0];try{e[ve]===1?Ko[Ye](a):Ko[Xe](a,dr(deleteByPath(sr(Ko[Ze](a)),e[Ie](1),value))),t(r)}catch(t){ao('Local Storage remove(keys: '+e[Te](',')+') error: '+t,['storage','localStorage'],'warn'),o(i)}}),Uo=(t,r)=>nr((i,o)=>{try{var a=ki(sr(Ko[Ze](t[0])),t[Ie](1));i(wi(r)[Se](e=>r[e]===a[e]))}catch(i){ao('Local Storage search(keys: '+t[Te](',')+' , criteria: '+dr(r)+') error: '+i,['storage','localStorage'],'warn'),o(e)}}),qo=(t,r,i,o)=>nr((a,n)=>{try{var s=ki(sr(Ko[Ze](t[0])),t[Ie](1)),d=tr(s),c=(d?s[ye]((e,t)=>[t,e]):Si(s))[_e](e=>{var[t,o]=e;return o[r]>=i})[Ie](-o);a(d?c[ye](e=>{var[t,r]=e;return r}):C['fromEntries'](c))}catch(a){ao('Local Storage clear(keys: '+t[Te](',')+' , dateKey: '+r+', dateLimit: '+i+', recordLimit: '+o+') error: '+a,['storage','localStorage'],'warn'),n(e)}}),Go=(e,t)=>Ni(e,t),jo=(e,t)=>!Go(e,t),Jo=(e,t)=>S(t)['toLowerCase']()[Ne](S(e)['toLowerCase']()),Zo=(e,t)=>!Jo(e,t),Xo=(e,t)=>S(t)['toLowerCase']()['startsWith'](S(e)['toLowerCase']()),Yo=(e,t)=>!Xo(e,t),Qo=(e,t)=>S(t)['toLowerCase']()['endsWith'](S(e)['toLowerCase']()),$o=(e,t)=>!Qo(e,t),ea=(e,t)=>(tr(t)?t:[t])[Pe](t=>e[Ne](t)),ta=(e,t)=>!ea(e,t),ra=(e,t)=>N(t)>N(e),ia=(e,t)=>N(t)>=N(e),oa=(e,t)=>N(t)<N(e),aa=(e,t)=>N(t)<=N(e),na={['EQUALS']:Go,['NOT_EQUALS']:jo,['LIKE']:Jo,['NOT_LIKE']:Zo,['STARTS_WITH']:Xo,['NOT_STARTS_WITH']:Yo,['ENDS_WITH']:Qo,['NOT_ENDS_WITH']:$o,['IN']:ea,['NOT_IN']:ta,['GREATER_THAN']:ra,['GREATER_EQUAL']:ia,['LESS_THAN']:oa,['LESS_EQUAL']:aa},sa=e=>{var t=(e['displayCondition']||{})['ruleSet']||{},r=(t['pageUrlFilters']||[])[ve]>0,i=(t['screenNameFilters']||[])[ve]>0,o=(t['rules']||[])[ve]>0;return r||i||o},da=(e,t,r,i)=>e[_e](e=>{var o=e['publicId'],a=t['onsiteMessageHistories'][o];return ca(e,a,t,r,i)}),ca=(t,o,a,n,d)=>{var c=t['publicId'],l=t['startDate'],u=hi(l),p=t['endDate'],m=hi(p),g=t['isRealtime'],v=t['triggerSettings']||{},f=t['displayCondition']||{},h=f['ruleSet']||{},y=h['rules'],b=h['logicOperator'],_=la(o||[]),w=v['maxShowCount'];w=w!=e?w:Ur;var P=v['showEveryXMinutes'];P=(P!=e?P:qr)*mi;var S=v['dontShowAfterClick'];S=S!=e?!!S:i;var N=hi(),I=_['lastDisplayTime']||0,C=_['displayCount']||0,k=_['clickCount']||0;if(u>=N)return ao(ar('Onsite Message(',c,') display canceled: message is not started yet, startDate: ',l),['onsite','condition']),i;if(m<N)return ao(ar('Onsite Message(',c,') display canceled: message is expired, endDate: ',p),['onsite','condition']),i;if(S&&k>=1)return ao(ar('Onsite Message(',c,') display canceled: message has "do not display after engage" rule, visitor already engaged with message'),['onsite','condition']),i;if(w>=0&&C>=U(w,1))return ao(ar('Onsite Message(',c,') display canceled: display limit is reached. Display Count:',C,' Limit: ',w||1),['onsite','condition']),i;if(P>=0&&I+P>N)return ao(ar('Onsite Message(',c,') display canceled: message can be displayed every ',P/mi,' minutes, message can be displayed again after ',I+P-N,' miliseconds'),['onsite','condition']),i;var T=(f['onsitePlatform']||Gr)['toLowerCase'](),x=yo();if(T!=='all'&&x!==T)return ao(ar('Onsite Message(',c,') display canceled: can be displayed in "',T,'"'),['onsite','condition']),i;var D=ji(s);if(g){if(!(f['whereToDisplay']||[])[(f['whereToDisplayLogicOperator']||'OR')['toLowerCase']()==='and'?Se:Pe](e=>{var t=i;return e['startsWith']('-')&&(t=r,e=e['slice'](1)),!!(!!D['match'](new RegExp(e['slice'](1,-1),'i'))-t)}))return ao(ar('Onsite Message(',c,') display canceled: URL regex conditions do not met'),['onsite','condition']),i;if(!ua(y,b,a,n,d))return ao(ar('Onsite Message(',c,') display canceled: Rules do not met'),['onsite','condition']),i}else{var O=h['pageUrlFilters']||[],E=(h['pageUrlFiltersLogicOperator']||'and')['toLowerCase']();if(!(O[ve]?O[E==='and'?Se:Pe](e=>{var t=e['operator'],r=e['value'],i=tr(r)&&r[ve]===1?r[0]:r;return na[t](i,D)}):r))return ao(ar('Onsite Message(',c,') display canceled: URL conditions do not met'),['onsite','condition']),i;var A=h['screenNameFilters']||[],L=(h['screenNameFiltersLogicOperator']||'and')['toLowerCase']();if(!(A[ve]?A[L==='and'?Se:Pe](e=>{var t=e['operator'],r=e['value'],i=tr(r)&&r[ve]===1?r[0]:r;return na[t](i,a['lastVisitedPageCategory'])}):r))return ao(ar('Onsite Message(',c,') display canceled: Screen Name conditions do not met'),['onsite','condition']),i}return ao(ar('Onsite Message(',c,') is displayable'),['onsite','condition']),r},la=e=>{for(var t=0,r=0,i=0,o=0;o<e[ve];o++){var a=e[o];t=U(t,a['displayTime']),r++,a['isClicked']&&i++}return{['lastDisplayTime']:t,['displayCount']:r,['clickCount']:i}},ua=(e,t,o,a,n)=>{t=t['toLowerCase']();for(var s=0;s<e[ve];s++){var d=e[s],c=pa(d['criterions'],d['logicOperatorBetweenCriterions'],o,a,n);if(t==='or'&&c)return r;if(t==='and'&&!c)return i}return r},pa=(e,t,o,a,n)=>{t=t['toLowerCase']();for(var s=0;s<e[ve];s++){var d=e[s],c=ma(d['valueSource'],d['parameter'],d['dataType'],d['comparison'],d['values'],o,a,n);if(t==='or'&&c)return r;if(t==='and'&&!c)return i}return r},ma=(e,t,r,i,o,a,n,s)=>{var d=ga(e,t,r,a,n,s),c=fa(o);if(r==='VISITCOUNTPASTXDAYS'){for(var l=0,u=0;u<H(c['timeAmount'],d[ve]);u++)l+=d[u];d=[l],c=[c['count']]}return['IN','NOT_IN'][Ne](i)||(d=d[0],c=c[0]),na[i](c,d)},ga=(e,t,r,a,n,s)=>{var d=fi(),c={['BROWSER']:{['dn.device_name']:()=>ar(fo(),' ',ho()),['dn.device_cat']:()=>yo()[0]['toUpperCase'](),['dn.ismobile']:()=>yo()==='mobile',['dn.os']:()=>mo(),['dn.os_ver']:()=>go(),['dn.browser']:()=>uo(),['dn.browser_ver']:()=>po(),['dn.sc_width']:()=>o['width'],['dn.sc_height']:()=>o['height'],['dn.lang']:()=>(vr()||'en')[ke]('-')[0],['dn.ad_blocker']:()=>i,['dn.tz']:()=>()=>bi(),['dn.hour']:()=>[d['getHours']()],['dn.week_day']:()=>[d['getDay']()],['dn.month']:()=>[d['getMonth']()+1],['dn.wp_enabled']:()=>s['isSupported'],['dn.wp_perm']:()=>s['permission']},['SESSION']:{['dn.last_visit_ts']:()=>a['lastVisitTime'],['dn.traffic_source']:()=>n['source'],['dn.referrer']:()=>n['referrerURL'],['dn.landing_url']:()=>n['entryURL'],['dn.first_visit']:()=>n['isFirst'],['dn.visit_duration']:()=>j((hi()-n['startTime'])/mi),['dn.visit_count']:()=>{var e=yi();return(a['visitsByDay']||[])[we]((t,r)=>{if(e<r['day'])return t;for(var i=0;i<e-r['day'];i++)t[fe](0);return t[fe](r['count']),t},[])},['dn.anonym']:()=>!a['contactKey'],['dn.pviv']:()=>n['pageViewCount'],['dn.utm_camp']:()=>n['campaign'],['dn.utm_m']:()=>n['medium'],['dn.utm_s']:()=>n['source'],['dn.utm_cnt']:()=>n['content'],['dn.utm_t']:()=>n['term'],['dn.cart_amount']:()=>ha(Jt['basketAmount']),['dn.cart_items']:()=>ha(Jt['basketCount']),['dn.cat_path']:()=>a['lastCategoryPage']},['DATA_LAYER']:{[t]:()=>Vo(t)},['LOCAL_STORAGE']:{[t]:()=>Ko['getItem'](t)},['COOKIE']:{[t]:()=>Lo(t)||''},['QUERYSTRING']:{[t]:()=>Qi(t)||''},['SERVER_SIDE']:{['dn.segment']:()=>a['segments'],['dn.tag']:()=>a['tags'],['dn.master_contact.birth_date']:()=>{var e=fi(a['attrs']['birth_date']),t=fi();return t['setYear'](e['getUTCFullYear']()),j((e-t)/vi)}}};return c['SERVER_SIDE']['hasOwnProperty'](t)||(c['SERVER_SIDE'][t]=()=>a['attrs'][key]),fa(c[e][t](),r)},va={['BOOL']:e=>S(e)['toLowerCase'](),['INT']:e=>z(e)||0,['TEXT']:e=>S(e)['toLowerCase'](),['VISITCOUNTPASTXDAYS']:e=>sr(e||{['count']:0,['timeAmount']:0}),['BIRTH']:e=>z(e)||0},fa=(e,t)=>(tr(e)?e:[e])[ye](e=>{var r=va[t];return r?r(e):e}),ha=t=>{var r=(t=t||{})['source']||'',i=t['value']||'';return i&&r?r==='DATA_LAYER'?Vo(i):r==='CUSTOM_JS'?_eval(i):void 0:e},ya=e=>{var t=e['message_json'],o=t['content'],a=t['displayTiming'],n=a['showEveryXMinutes'],s=t['displayCondition'],d=s['whenToDisplay'],c=['HOME_PAGE','ANY_PAGE'][Ne](d);return{['groupId']:ie,['publicId']:e['smsg_id'],['startDate']:fi()['toJSON'](),['endDate']:t['expireDate'],['priority']:t['priority'],['status']:Jr,['isRealtime']:i,['messageDetails']:t['messageDetails'],['content']:{['contentType']:o[Ke],['contentId']:o['publicId']||o['contentId']||o['id']||ie,['props']:o['props']},['triggerSettings']:{['triggerBy']:a['triggerBy'],['delay']:a['delay'],['showEveryXMinutes']:n,['maxShowCount']:n?Ur:1,['eventName']:ie,['scrollPercentage']:0,['doNotShowAfterClick']:r},['displayCondition']:{['whereToDisplay']:d==='HOME_PAGE'?[Zr]:[],['onsitePlatform']:Gr,['ruleSet']:{['pageUrlFilters']:(c?[]:s['pageUrlFilters'])||[],['pageUrlFiltersLogicOperator']:s['pageUrlFiltersLogicOperator'],['screenNameFilters']:(c?[]:s['screenNameFilters'])||[],['screenNameFiltersLogicOperator']:s['screenNameFiltersLogicOperator'],['logicOperator']:jr,['rules']:[]}}}},ba={High:1,Medium:2,Low:3},_a=e=>e[Ie]()['sort']((e,t)=>{var r=e['priority'],i=ba[r]||r,o=hi(e['endDate']),a=sa(e),n=sa(e),s=t['priority'],d=ba[s]||s,c=hi(t['endDate']),l=sa(t),u=sa(t);return r!==s?i-d:n!==u?u-n:a!==l?l-a:o-c}),wa=(t,r,i,o)=>nr(a=>{if(t['content'])return a(t['content']);var n=t['publicId'],s={['campaignId']:n,['culture']:hr(),['deviceId']:r};return t['isAbCampaign']&&i&&(s['contentId']=i),wo(Xi(s))[ue](r=>{var i=r['error'];i&&ao(ar('Onsite message(',n,') content get failed, status:',r['status'],' error:',i),['onsite','http'],'warn');var s=r['data']?r['data']['content']:e;s&&t['isAbCampaign']&&o&&ir(o)&&o(n,s['publicId']),a(s)})}),Pa={['sharedCssText']:'',['sharedJsText']:'',['containerCssText']:'',['formHandlerJsText']:''},Sa=(e,t)=>Pa[t]?x[de](Pa[t]):e()[ue](e=>{var r=e['data'];return Pa[t]=r,r}),Na=e=>x[le]([Sa(Io,'sharedCssText'),Sa(No,'sharedJsText'),Sa(Co,'containerCssText'),e[Ne]('data-dn-form-id="subscription_form"')||e[Ne]('data-dn-form-id="question_form"')?Sa(ko,'formHandlerJsText'):''])[ue](t=>{var[r,i,o,a]=t;if(!n['querySelector']('#dengage_container_style')){var s=Li('style',{['id']:'dengage_container_style',['type']:'text/css',['innerHTML']:o});Ri(s,y)}return e[me]('</head>',ar('<style>',r,'</style></head>'))[me]('</body>',ar('<script>',i,'<\/script></body>'))[me]('</body>',ar('<script>',a,'<\/script></body>'))}),Ia=(t,r)=>{var[i,o,a,n]=t,s=da(i,o,a,n);return x[le](s[ye](t=>wa(t,o['deviceId'],o['onsiteABContentIds']&&o['onsiteABContentIds'][t['publicId']]||e,r)[ue](e=>(t['content']=e,t))))},Ca=Xr*pi,ka=[],Ta=(t,r,i,o,a,n)=>{var s={['acc']:dt,['camp']:t['publicId'],['content']:t['content']['publicId'],['sid']:i,['did']:o,['event']:r};if(a&&(s['ckey']=a),n!=e&&(rr(n)?(s['event']=r==='CL'?'SC':'SD',s['stPrId']=n['stPrId'],s['stPrName']=n['stPrName'],s['stId']=n['stId'],s['stName']=n['stName']):s['btn']=n),ka[Pe](e=>Ni(s,e)))return ao('Onsite Realtime Message Event request blocked, same payload sent recently',['onsite','realtime','event','http'],'warn'),x[de]();var d=ka[ve];return ka[fe](s),Hi(Xi(s))[ue](()=>{Y(()=>{ka[Ce](d,1)},Ca)})},xa=[],Da=(e,t,r,i,o)=>{if(!e['messageDetails'])return x[de]();var a={['acc']:dt,['did']:r,['cdkey']:i||r,[Ke]:i?'c':'d',['message_details']:e['messageDetails']};if(o&&(a['button_id']=o),xa[Pe](e=>Ni(a,e)))return ao('Onsite Flow Message Event request blocked, same payload sent recently',['onsite','flow','event','http'],'warn'),x[de]();var n=xa[ve];return xa[fe](a),Ui(t,Xi(a))[ue](()=>{Y(()=>{xa[Ce](n,1)},Ca)})},Oa=(e,t,r)=>{var i=e['content'],o=i['props'],a=o['html'],n=!!e['inlineTarget'];if(i['contentType']==='AB_CONTROL_GROUP')return ao(ar('AB Control Group Onsite message(',e['publicId'],') no content is shown but assumed as displayed'),['onsite'],'info'),x[de](e);if(a[Ne]('data-tf-type'))return Ea(e,t,r);if(n){var s=Ei(a);if(a[Ne]('class="dn-inline-story-data" type="application/json"')){var d=s['querySelector']('.dn-inline-story-data'),c=d&&d.innerHTML||'';return o['storySet']=sr(c['replace'](/True/gm,'true')['replace']('false')),Fa(e,t,r)}var l=s['querySelector']('.dn-inline-style'),u=s['querySelector']('.dn-inline-html'),p=s['querySelector']('.dn-inline-script');return o['inline']={['style']:l,['html']:u,['script']:p},La(e,r)}return Va(e,t,r)},Ea=(t,o,n)=>{var s=o['deviceId'],d=o['contactKey'],c=n['onClick'],l=n['onClose'],u=t['publicId'],p=t['isRealtime'],m=t['content']['props']['html'],g=Ei(m)['body']['dataset'],v=g['tfId'],f=g['tfSize'],h=g['tfUniqify']==='true',b=g['tfUniqifyColumnName'],_=g['tfUniqifyColumnValue'],w=g['tfUniqifyHiddenKey'];return x[de](h?nr(e=>{var t=!_||_['startsWith']('{%=')||_['endsWith']('%}')?o['attrs'][b]:_;return t?getTypeformSurveyAvailability(v,t)[ue](e):e(i)}):r)[ue](r=>{if(bo['isAPopupBeingDisplayed'])return ao(ar('Another popup is being displayed, onsite Typeform popup message(',u,') display canceled'),['onsite'],'info'),x[ce](t);var i=(o['lastOnsitePopupDisplayTime']||0)+Gt*pi;if(i>hi())return ao(ar('Popup display cooldown is not expired, Typeform popup message(',u,') display canceled. Earliest popup display time: ',fi(i)['toISOString']()),['onsite'],'info'),x[ce](t);if(!r)return ao('Onsite Typeform popup message cannot be displayed',['onsite','typeform']),x[ce](t);var n=e;return nr((e,r)=>{var i=Li('link',{['rel']:'stylesheet',['href']:Er}),o=Li('script',{['src']:Ar});Fi(o,'load',()=>{var i={['dn_contact_key']:d,['dn_device_id']:s,['dn_send_id']:p?'':u[ke]('-')[1],['dn_campaign_id']:p?u:'',['dn_channel']:(p?'realtime':'')+'onsite',['dn_uniqify']:h,['dn_integration_key']:gt};h&&(i[w]=_),a['tf']['createPopup'](v,{['open']:'load',['size']:J(f)?75:f,['hideHeaders']:g['tfHideHeaders']==='true',['hidden']:i,['onClose']:l,['onSubmit']:()=>c('primary'),['onReady']:()=>{ao(ar('Onsite typeform message(',u,') displayed, typeform id: ',v),['onsite'],'info'),e(t)}});var o=Lr*pi;n=Y(()=>{ao(ar('Onsite Typeform message cannot be displayed: Typeform SDK load timeout(',o,' second(s))'),['onsite','typeform'],'warn'),r(t)},o)}),Ri(i,y),Ri(o,y)})[ue](()=>(Q(n),t))})},Aa={},La=(e,t)=>{var o=e['publicId'],a=e['inlineTarget']||{},s=a['selector'],d=a['type'],c=e['content']['props']['inline'],l=c['style'],u=l&&l['innerHTML']||'',p=c['html'],m=p&&p['innerHTML']||'',g=c['script'],v=g&&g['innerHTML']||'',f=t['onClick'],h=i,b=!!u&&!n['querySelector'](ar('[data-dn-inline-id="',o,'"]'));if(b){var _=l['cloneNode'](r);_['dataset']['dnInlineId']=o;try{Ri(_,y),h=r}catch(e){ao(ar('Onsite Inline CSS injection error: ',e),['onsite','inline'],'warn')}}var w=0,P=!!m&&Ba(a);if(P)for(var S=n['querySelectorAll'](s),N=function e(){var t=S[I];if(d==='Fill'){if(t['dataset']['dnInlineReserved']&&t['dataset']['dnInlineReserved']!==o)return ao('This inline target is reserved for '),1;t['dataset']['dnInlineReserved']=o,t['innerHTML']=ie}for(var i=p['cloneNode'](r),a=i['querySelectorAll']('a[href]'),n=function e(){var t=a[s];Fi(t,'click',()=>{f(t['href'])})},s=0;s<a[ve];s++)n();i['tagName']==='A'&&i['href']&&Fi(i,'click',()=>{f(i['href'])}),i['dataset']['dnInlineId']=o,i['dataset']['dnInlineIndex']=w;try{Ri(i,t,d['toLowerCase']()),w++}catch(e){ao(ar('Onsite Inline HTML injection error: ',e),['onsite','inline'],'warn')}},I=0;I<S[ve];I++)N();var C=i,T=!!v;if(T){var D=k(v);Aa[o]={['code']:D,['isExecuted']:i,['error']:ie};try{Aa[o]['isExecuted']=r,D(),C=r}catch(e){Aa[o]['error']=e,ao(ar('Onsite Inline script injection error: ',e),['onsite','inline'],'warn')}}return b&&!h||P&&!w||T&&!C?x[ce]('injections failed'):(ao(ar('Onsite inline message(',o,') is displayed'),['onsite'],'info'),x[de](e))},Ra=(e,t)=>({['stPrId']:e[Oe],['stPrName']:e[Ee],['stId']:t[Oe],['stName']:t[Ee]}),Fa=(i,o,a)=>{var s=i['publicId'];if(n['querySelector'](ar('[data-dn-story-set-id="',s,'"]')))return ao(ar('Story display canceled, message(',s,') already displaying')),x[ce](i);var d=i['inlineTarget']||{},c=d['selector'],l=d['type'],u=i['content']['props']['storySet'];o['storySetVisits']||(o['storySetVisits']={[s]:[]}),o['storySetVisits'][s]||(o['storySetVisits'][s]=[]),u[Oe]=s,u['covers']['map']((t,r)=>{var i=t[Oe];return t[Oe]=i!=e?i:r,t['isVisited']=o['storySetVisits'][s][Ne](i),t});var p=a['onSubDisplay'],m=a['onSubClick'],g=a['onStoryVisit'];return za()[ue](e=>{var t=new e(u,c,l,(e,t)=>p(Ra(e,t)),(e,t)=>m(Ra(e,t)),g);return bo['storyEngine']=t,t['initialize']()})[ue](()=>(ao(ar('Onsite Story message(',s,') is displayed'),['onsite'],'info'),i))[pe](e=>{throw ao(ar('Story Engine error: ',e),['onsite','external','storyEngine'],'warn',t,r),i})},Ma={['LEFT']:'flex-start',['CENTER']:'center',['RIGHT']:'flex-end',['TOP']:'flex-start',['MIDDLE']:'center',['BOTTOM']:'flex-end'},Va=(t,o,s)=>{var d=t['publicId'],c='_dn_onsite_popup-'+d,l=(t['content']||{})['props']||{},u=l['isCloseButtonActive']||i,p=l['dismissOnClickOutside']||i,m=l['closeButtonColor']||'#aaa',g=l['maxWidth'],f=l['offset'],h=a['innerWidth']>g?ar(g,'px'):'100vw',y=l['offset']*2+20,_=l['isFixed'],w=l['position'],P=['TOP','BOTTOM'][Ne](w),S=l['html']||'',N=s['onClick'],I=s['onClose'],C=s['onSubmitForm'],k=s['onSubmitTags'];return Na(S)[ue](i=>{if(bo['isAPopupBeingDisplayed'])return ao(ar('Another popup is being displayed, onsite popup message(',d,') display canceled'),['onsite'],'info'),x[ce](t);var s=(o['lastOnsitePopupDisplayTime']||0)+Gt*pi;if(s>hi())return ao(ar('Popup display cooldown is not expired, message(',d,') display canceled. Earliest popup display time: ',fi(s)['toISOString']()),['onsite'],'info'),x[ce](t);var g=Li('iframe',{[Oe]:c,['src']:jt?ar('https://',nt,'/onsite-initiator/index.html'):ar('data:text/html,',Z(i))},[['border','none','important'],['width','100%','important'],['height','0','important']]),T=e=>{if(n['querySelector']('#'+c)||D(),g&&e['source']===g['contentWindow']){var t=e[Ae]||{},i=t['action'],o=t['buttonId']||'primaryButton';if(i==='height'&&Ai(g,['height',t[Le]+'px','important']),i==='openUrl'&&t['url']&&a['open'](t['url'],t['newTab']?'_blank':'_self'),i==='setTags'&&k(t['tags']||[])[ue](()=>d(r))[pe](l),i==='copyText'){var s=t['text'];v['writeText'](s)}['postSubscription','postSubscriptionWithTags'][Ne](i)&&C(t['form'])[ue](e=>{var r=t['tags'];return!(!r||!r[ve])&&k(r)})[ue](d)[pe](l),['sendClick','copyText'][Ne](i)&&(N(o),E()),['dismiss','close'][Ne](i)&&E()}function d(e){O('closeForm',e?'tagsSuccess':'success'),N(o)}function l(){O('closeForm','error')}},D=()=>Mi(a,'message',T),O=(e,t)=>g['contentWindow']['postMessage']({['action']:e,['status']:t},'*'),E=()=>{D(),I(),Ka(A,P)};Fi(a,'message',T);var A=e;if(P){var L=w[Ne]('TOP');A=Li('div',{['className']:'_dn_onsite-banner'},[['position',_?'fixed':'absolute','important'],[L?'top':'bottom','-200px','important']]),Fi(g,'load',()=>{Ai(A,['transform','translateY('+(L?'':'-')+'200px)','important']),jt&&g['contentWindow']['postMessage']({['html']:S},'*')}),Ri(g,A)}else{var R=w,F='CENTER';if(w[Ne]('_')){var M=w[ke]('_');R=M[0],F=M[1]}A=Li('div',{['className']:'_dn_onsite-overlay'},[['justify-content',Ma[F],'important'],['align-items',Ma[R],'important']]);var V=Li('div',{['className']:'_dn_onsite-modal'},[['max-width',h,'important'],['max-height',ar('calc(100vh - ',y,'px)'),'important'],['padding',(F==='CENTER'&&R==='MIDDLE'?0:f)+'px','important']]);if(Fi(g,'load',()=>{Ai(A,['opacity','1','important']),jt&&g['contentWindow']['postMessage']({['html']:S},'*')}),u){var K=Li('div',{['className']:'_dn_onsite-close',['innerHTML']:'<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d= "M22.0303 11.0296C22.3232 10.7367 22.3232 10.2618 22.0303 9.96894C21.7374 9.67604 21.2626 9.67604 20.9697 9.96894L16 14.9386L11.0303 9.96894C10.7374 9.67604 10.2626 9.67604 9.96967 9.96894C9.67678 10.2618 9.67678 10.7367 9.96967 11.0296L14.9393 15.9993L9.96967 20.9689C9.67678 21.2618 9.67678 21.7367 9.96967 22.0296C10.2626 22.3225 10.7374 22.3225 11.0303 22.0296L16 17.0599L20.9697 22.0296C21.2626 22.3225 21.7374 22.3225 22.0303 22.0296C22.3232 21.7367 22.3232 21.2618 22.0303 20.9689L17.0607 15.9993L22.0303 11.0296Z" fill="currentColor" fill-opacity="0.7"/></svg>'},[['color',m,'important']]);Ri(K,V),Fi(K,'click',E)}p&&Fi(A,'click',e=>{e['target']===A&&E()}),Ai(g,['border-radius',l['cardRadius']+'px','important']),Ri(V,A),Ri(g,V)}return Ri(A,b),bo['isAPopupBeingDisplayed']=r,ao(ar('Onsite ',P?'banner':'popup',' message(',d,')',' displayed'),['onsite'],'info'),x[de](t)})},Ka=(e,t)=>{Ai(e,t?['transform','translateY(0)','important']:['opacity','0','important']),Y(()=>{e['remove'](),bo['isAPopupBeingDisplayed']=i},500)},Ba=(e,t)=>{if(!e)return i;var o=e['selector']||'',a=e['type']||'';return o&&a&&['Fill','Start','End','Before','After'][Ne](a)&&n['querySelector'](o)?r:i};function za(){return a['DengageStoryEngine']?x[de](a['DengageStoryEngine']):nr((e,t)=>{var r=Li('script',{['src']:ar(Yt,Hr)}),i=Y(()=>{t('script load timeout')},5*pi);Fi(r,'load',()=>{Q(i),e(a['DengageStoryEngine'])}),Fi(r,'error',()=>{Q(i),t('script error')}),Ri(r)})}function Wa(){return a['InlineTargetSelector']?x[de](a['InlineTargetSelector']):nr((e,t)=>{var r=Li('script',{['src']:ar(Yt,Wr)}),i=Y(()=>{t('script load timeout')},5*pi);Fi(r,'load',()=>{Q(i),e(a['InlineTargetSelector'])}),Fi(r,'error',()=>{Q(i),t('script error')}),Ri(r)})}function Ha(){return nr(e=>{if(!w[Ne]('dengage.com')&&!w[Ne]('localhost:8080'))return e(i);var o=Y(()=>{ao('No external message received in 5 seconds, aborting external mode',['onsite','external'],'warn',t,r),e(i)},5*pi);Fi(a,'message',e=>{var i=e['data'],a=e['source'];if(i['_dn_onsite_message']){ao('External onsite preview message received',['onsite','external'],'info',t,r),a['postMessage']({['action']:'dnPreviewMessageReceived'},'*');var n={['onDisplay']:()=>ao('Preview message displayed',['onsite','external','preview'],'info',t,r),['onClick']:()=>ao('Preview message clicked',['onsite','external','preview'],'info',t,r),['onClose']:()=>ao('Preview message dismissed',['onsite','external','preview'],'info',t,r)};Oa({['publicId']:'preview',['content']:e['data']['message']},{},n)}else{if(!i['_dn_inline_target_selector']||i['message']!=='start')return;ao('External inline target selector message received',['onsite','external','inlineTargetSelector'],'info',t,r),Wa()[ue](e=>(bo['inlineTargetSelector']=new e(i['keyword'],a),bo['inlineTargetSelector']['initialize']()))[ue](e=>{ao('Inline Target Selector is active',['onsite','external','inlineTargetSelector'],'info',t,r),a['postMessage']({['message']:'dnInlineTargetSelectorActive',['details']:e},'*')})[pe](e=>{ao(ar('Inline Target Selector error: ',e),['onsite','external','inlineTargetSelector'],'warn',t,r),a['postMessage']({['message']:'dnInlineTargetSelectorError',['details']:e},'*')})}Q(o)}),e(r)})}var Ua,qa=e=>e[ke]('-')[Te]('+')[ke]('_')[Te]('/')[me](/^\=+|\=+$/g,ie),Ga=e=>{for(var t=ie,r=new A(e),i=0;i<r['byteLength'];i++)t+=S['fromCharCode'](r[i]);return $(t)},ja=()=>p&&'getRandomValues'in p?p['getRandomValues'](new A(1))[0]&15:q()*16|0,Ja=()=>p&&'randomUUID'in p?p['randomUUID']():'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'[me](/[xy]/g,e=>{var t=ja();return(e=='x'?t:t&3|8)['toString'](16)}),Za=e=>{var t=(new R)['encode'](e);return p['subtle']['digest']('SHA-256',t)[ue](e=>I['from'](new A(e))[ye](e=>e['toString'](16)['padStart'](2,'0'))[Te](ie))},Xa=t=>Bi(ar('https://',at,'/api/web/subscription'),t,e,0),Ya=t=>Bi(ar('https://',at,'/api/setTags'),t,e,0),Qa=e=>Ki(ar('https://',at,'/api/audience/visitor-info',e)),$a=[['deviceId','d'],['contactKey','c'],['sessionId','s'],['isV1StorageMigrated','m']],en=[['deviceId','d'],['contactKey','c'],['totalPageViewCount','tvc'],['totalSessionCount','tsc'],['lastOnsitePopupDisplayTime','lodt'],['lastVisitTime','lvt'],['trackingPermission','tp'],['userPermission','up'],['country','cnt'],['pushNotificationSubscription','w',[['data','s'],['token','tk'],['domain','d'],['type','ty']]],['pushNotificationPermissionPrompts','p',[['blockedInfoDisplayCount','bic'],['lastBlockedInfoDisplayTime','bit'],['lastCustomPromptResponse','cpr'],['lastNativePromptResponse','npr'],['lastPromptDisplayTime','cpt']]]],tn=[['sessionId','s'],['deviceId','d'],['advertisingId','a'],['dengageChannel','dch'],['dengageSendId','ds'],['entryURL','eu'],['referrerURL','ru'],['startTime','st'],['endTime','et'],['isFirst','f'],['campaign','cmp'],['content','cnt'],['medium','m'],['source','so'],['term','te'],['type','ty'],['pageViewCount','vc']],rn=(e,t,r)=>{for(var i={},o=r?1:0,a=r?0:1,n=0;n<t[ve];n++){var s=t[n];i[s[o]]=s[2]?rn(e[s[a]],s[2],r):e[s[a]]}return i},on=(t,r)=>{var o=Lo(t);return o?ur(o)[ue](t=>t?rn(t,r,i):e)[pe](t=>(ao(ar('Data Decompression error: ',t),['cookie'],'warn'),e)):x[de](e)},an={},nn=(t,o,a)=>an[t]?nr(e=>{Y(()=>{e(nn(t,o,a))},100)}):(an[t]=r,on(t,a)[ue](i=>lr(rn(Oi(i=i||{},o),a,r))[ue](r=>r?Ro(t,r,365*(vi/1e3),To,'/'):e)[pe](t=>(ao(ar('Data Compression error: ',t),['cookie'],'warn'),e)))[ue](e=>(an[t]=i,e))),sn=(t,r,i,o)=>nr((a,n)=>{if(Ua)a(Ua);else{var s=u['open'](t,r);s['onupgradeneeded']=e=>{var t=e['target']['result'],r=Si(i);for(var a of r){var n=a[0],s=a[1];t['objectStoreNames']['contains'](n)||(s?t['createObjectStore'](n,{['keyPath']:s,['autoIncrement']:o[Ne](n)}):t['createObjectStore'](n))}},s['onsuccess']=e=>{Ua=e['target']['result'],a(Ua)},s['onerror']=i=>{Ua=e,ao('IndexedDb get Database(dbName: '+t+' , version: '+r+') error: '+i,['storage','indexedDb'],'warn'),n(e)}}}),dn=(t,r,i,o,a,n)=>nr((s,d)=>sn(t,r,i,o)[ue](t=>{var r=t['transaction'](a,'readonly')['objectStore'](a),i=n!=e?r[Re](n):r['getAll']();i['onsuccess']=e=>{s(e['target']['result']?e['target']['result']:null)},i['onerror']=t=>{ao('IndexedDb get(storeName: '+a+' , key: '+n+') error: '+t,['storage','indexedDb'],'warn'),d(e)}})[pe](t=>{d(e)})),cn=(e,o,a,n,s,d,c)=>nr((l,u)=>sn(e,o,a,n)[ue](e=>{var o=e['transaction'](s,'readwrite')['objectStore'](s),a=o['put'](c,o['keyPath']?t:d);a['onsuccess']=e=>{l(r)},a['onerror']=e=>{ao('IndexedDb set(storeName: '+s+' , key: '+d+' , value:'+dr(c)+') error: '+e,['storage','indexedDb'],'warn'),u(i)}})[pe](e=>{u(i)})),ln=(e,t,o,a,n,s)=>nr((d,c)=>sn(e,t,o,a)[ue](e=>{var t=e['transaction'](n,'readwrite');t['objectStore'](n)['delete'](s),t['oncomplete']=e=>{d(r)},t['onerror']=e=>{ao('IndexedDb remove(storeName: '+n+' , key: '+s+') error: '+e,['storage','indexedDb'],'warn'),c(i)}})[pe](e=>{c(i)})),un=(t,r,i,o,a,n)=>nr((s,d)=>sn(t,r,i,o)[ue](t=>{var r=t['transaction'](a,'readonly')['objectStore'](a)['openCursor']();r['onsuccess']=t=>{var r=t['target']['result'];if(r){var i=r['value'];if(wi(n)[Se](e=>n[e]===i[e]))return s(i);r['continue']()}else s(e)},r['onerror']=t=>{ao('IndexedDb search(storeName: '+a+' , criteria: '+dr(n)+') error: '+t,['storage','indexedDb'],'warn'),d(e)}})[pe](t=>{d(e)})),pn=(t,r,i,o,a,n,s,d)=>nr((c,l)=>sn(t,r,i,o)[ue](t=>{var r=t['transaction'](a,'readwrite')['objectStore'](a)['openCursor'](e,'prev'),i=0,o=0;r['onsuccess']=e=>{var t=e['target']['result'];t?((t.value[n]||0)<s||i>=d?(t['delete'](),o++):i++,t['continue']()):c({['recordCount']:i,['deleteCount']:o})},r['onerror']=e=>{c({['recordCount']:i,['deleteCount']:o})}})[pe](t=>{ao('IndexedDb clear(storeName: '+a+' , dateKey: '+n+', dateLimit: '+s+', recordLimit: '+d+') error: '+t,['storage','indexedDb'],'warn'),l(e)})),mn=Nr+' '+it+'/'+dt+'/'+mt,gn=()=>nr(e=>{var t='_dn_access_test';try{var o=a['localStorage'];o['setItem'](t,'1'),o['removeItem'](t),e(r)}catch(t){e(i)}}),vn=()=>nr(e=>{var t='dn_access_test';try{if(!a['indexedDB']||Qt(a['indexedDB']['open'])!=='function')return e(i);var o=a['indexedDB']['open'](t);o['onsuccess']=i=>{i['target']['result']['close'](),a['indexedDB']['deleteDatabase'](t)['onsuccess']=()=>e(r)},o['onerror']=()=>e(i),o['onblocked']=()=>e(i)}catch(t){e(i)}}),fn=()=>nr(e=>{var t='_dn_test';try{n['cookie']=Eo(t,'1',3600,l,'/'),n['cookie']['indexOf'](t)!==-1?(n['cookie']=Eo(t,'1',0,l,'/'),e(r)):e(i)}catch(t){e(i)}}),hn=(e,t)=>[Ir+e][he](t?tr(t)?t:[t]:[]),yn=(t,r)=>dn(mn,Sr,si,[ai],t,r)[pe](()=>Bo(hn(t,r))[pe](()=>e)),bn=(e,t,r,o)=>cn(mn,Sr,si,[ai],e,t,r)[pe](a=>o?i:Wo(hn(e,t),r)),_n=(e,t,r)=>ln(mn,Sr,si,[ai],e,t)[pe](r=>Ho(hn(e,t))[pe](()=>i)),wn=(e,t)=>un(mn,Sr,si,[ai],e,t)[pe](()=>Uo(e,t)[pe](()=>i)),Pn=(e,t,r,o,a)=>pn(mn,Sr,si,[ai],e,t,r,o)[pe](a=>qo(e,t,r,o)[pe](()=>i)),Sn=()=>yn(ei,'deviceId')[ue](t=>t==e?Xn()[ue](e=>(e=e||{})['deviceId']):t),Nn=e=>x[le]([Wo(hn(ei,'deviceId'),e),Yn({['deviceId']:e}),bn(ei,'deviceId',e,i)]),In=()=>yn(ei,'contactKey')[ue](t=>t==e?Xn()[ue](e=>(e=e||{})['contactKey']):t),Cn=e=>x[le]([Wo(hn(ei,'contactKey'),e),Yn({['contactKey']:e}),bn(ei,'contactKey',e,i)]),kn=()=>yn(ei,'sessionId')[ue](t=>t==e?Xn()[ue](e=>(e=e||{})['sessionId']):t),Tn=e=>x[le]([Wo(hn(ei,'sessionId'),e),Yn({['sessionId']:e}),bn(ei,'sessionId',e,i)]),xn=()=>yn(ei,'isV1StorageMigrated')[ue](t=>t==e?Xn()[ue](e=>(e=e||{})['isV1StorageMigrated']):t),Dn=e=>x[le]([Wo(hn(ei,'isV1StorageMigrated'),e),Yn({['isV1StorageMigrated']:e}),bn(ei,'isV1StorageMigrated',e,i)]),On=()=>yn(ei,'isDebugMode')[ue](t=>t==e?Xn()[ue](e=>(e=e||{})['isDebugMode']):t),En=e=>x[le]([Wo(hn(ei,'isDebugMode'),e),Yn({['isDebugMode']:e}),bn(ei,'isDebugMode',e,i)]),An=e=>yn(ti,e),Ln=()=>Sn()[ue](t=>t?An(t):e),Rn=(e,t)=>($n(t),yr()?x[le]([Wo(hn(ti,e),t),bn(ti,e,t,i)]):bn(ti,e,t)),Fn=e=>yn(ri,e),Mn=(e,t)=>bn(ri,e,t),Vn=e=>yn(ii,e),Kn=()=>kn()[ue](t=>t?Vn(t)[ue](t=>t?es():e):e),Bn=(e,t)=>(ts(t),yr()?x[le]([Wo(hn(ii,e),t),bn(ii,e,t,i)]):bn(ii,e,t)),zn=e=>_n(ii,e),Wn=e=>wn(ii,e),Hn=()=>yn(oi),Un=e=>yn(oi,e),qn=(e,t)=>bn(oi,e,t),Gn=e=>_n(oi,e),jn=t=>An(t)[ue](e=>e?x[le](e['flowOnsite']['messageIds'][ye](e=>Un(e))):[])[ue](t=>t[we]((t,r)=>(r!=e&&t[fe](r[Ae]),t),[])),Jn=(e,t,r)=>Pn(ai,e,hi()-t*vi,r),Zn=(e,t,r)=>Pn(ni,e,hi()-t*vi,r),Xn=()=>on(Cr,$a),Yn=e=>nn(Cr,e,$a),Qn=()=>on(kr,en),$n=e=>nn(kr,e,en),es=()=>on(Tr,tn),ts=e=>nn(Tr,e,tn),rs=()=>x[le]([Qn(),es(),Xn()]),is=()=>_t?Ln()[ue](e=>!(!e||!e['trackingPermission'])):x[de](i),os=(e,t,r)=>(r?x[de](r):Sn())[ue](r=>as(e,r,t)),as=(e,t,r)=>is()[ue](o=>o?kn()[ue](i=>Wi(e,t,Oi({['session_id']:i},r))):(ao('Tracking is disabled, event request aborted',['event','http']),x[de](i))),ns=e=>((e=e||{})['page_url']=d,e['page_title']=h,ao('Page view event is sent',['pageView','event','http']),os('page_view_events',e)),ss=(t,r,i)=>{var o=!!t,a=!!r;return ao(ar('Active visitor process started, deviceId:',t,' contactKey:',r),['visitor']),x[le]([o?An(t):x[de](e),a?Fn(r):x[de](e),Sn(),In(),Ln()])[ue](i=>{var[n,s,d,c,l]=i,u=!!n,p=!!s,m=u&&!!n['contactKey'],g=u&&n['contactKey']===r,v=!!l&&!!l['contactKey'];return yt?(ao('"Multiple contacts on single device" feature is enabled. Active visitor was not changed, its data are going to be overriden',['visitor']),n=l||ds(t,r),o&&(n['deviceId']=t),a?(n['contactKey']=r,Mn(r,{['deviceId']:n['deviceId'],['contactKey']:r})[ue](e=>(ao(ar('Contact stored, contactKey:',r),['visitor']),n))):n):o&&a?(ao('deviceId and contactKey passed',['visitor']),g?(ao('Passed deviceId and contactKey pair already stored',['visitor']),n):(u&&(m?(n=ds(e,r),ao(ar('Passed deviceId have a contactKey, new visitor created with passed contactKey, deviceId:',n['deviceId']),['visitor'])):(n['contactKey']=r,ao('Passed deviceId does not have a contactKey, passed contactKey stored',['visitor']))),u||(n=ds(t,r),ao('Passed deviceId does not stored, new visitor visitor created with passed deviceId and contactKey',['visitor'])),Mn(r,{['deviceId']:n['deviceId'],['contactKey']:r})[ue](e=>(ao(ar('Contact stored, contactKey:',r),['visitor']),n)))):o&&!a?(ao('Only deviceId is passed',['visitor']),u?(ao('Passed deviceId is already stored',['visitor']),n):(ao('Passed deviceId is not stored, new visitor created with passed deviceId',['visitor']),ds(t))):!o&&a?(ao('Only contactKey is passed',['visitor']),p?(ao('Passed contactKey is already stored',['visitor']),An(s['deviceId'])):v?(n=ds(e,r),ao('Passed contactKey is not stored and active visitor has another contactKey, new visitor created with passed contactKey',['visitor']),Mn(r,{['deviceId']:n['deviceId'],['contactKey']:r})[ue](e=>(ao(ar('Contact stored, contactKey:',r),['visitor']),n))):(l['contactKey']=r,Mn(r,{['deviceId']:l['deviceId'],['contactKey']:r})[ue](e=>(ao(ar('Contact stored, contactKey:',r),['visitor']),l)))):(ao('deviceId and contactKey are not passed',['visitor']),l?(ao('Active visitor found, no changes applied',['visitor']),l):(ao('No active visitor data found on storage, trying to generate a visitor with any remaining data',['visitor']),Qn()[ue](e=>{var t,r,i,o='';return d&&(o+='Active device id found',t=d),c&&(o+=(o?', ':'')+'Active contact key found',r=c),e&&e['deviceId']===t&&(o=(o?', ':'')+'Visitor data from cookie matches with active device id',i=e),!d&&r&&e&&(o+=(o?', ':'')+'Visitor data from cookie found',t=e['deviceId'],r=e['contactKey'],i=e),ao(o?o+'. Generating new visitor with remaining data. deviceId: '+t:'No data remained, creating new visitor',['visitor']),ds(t,r,i)})))})[ue](e=>{var t=e['deviceId'],r=e['contactKey'];i&&(e['lastVisitedPageCategory']=i);var o=[()=>Nn(t),()=>Rn(t,e)];return r&&o[fe](()=>Cn(r)),x[le](o[ye](e=>e()))[ue](t=>e)})},ds=(t,i,o)=>Oi({['country']:ie,['userPermission']:r,['trackingPermission']:r,['segments']:[],['tags']:[],['attributes']:{},['lastServerSideDataRequest']:{['payload']:{},['response']:{['status']:0,['body']:ie},['time']:0},['lastSubscriptionRequest']:{['payload']:{},['response']:{['status']:0,['body']:ie},['time']:0},['lastVisitedPageCategory']:ie,['lastVisitTime']:hi(),['totalPageViewCount']:0,['totalSessionCount']:0,['visitsByDay']:[],['pushNotificationSubscription']:{['token']:ie,['type']:ie,['data']:e,['domain']:ie},['pushNotificationPermissionPrompts']:{['lastPromptDisplayTime']:0,['lastCustomPromptResponse']:ie,['lastNativePromptResponse']:ie,['blockedInfoDisplayCount']:0,['lastBlockedInfoDisplayTime']:0},['lastOnsitePopupDisplayTime']:0,['flowOnsite']:{['lastGetTime']:0,['mostRecentMessageCreateTime']:0,['messageIds']:[]},['onsiteMessageHistories']:{},['storySetVisits']:{}},o||{},{['deviceId']:t||Ja(),['contactKey']:i||ie}),cs=e=>Ln()[ue](t=>t[e]),ls=(e,t)=>Ln()[ue](i=>Ni(i[e],t)?r:(i[e]=t,Rn(i['deviceId'],i)[ue](()=>ps(i)))),us=e=>{var t=Mr*mi,r={['acc']:dt,['did']:e['deviceId'],['ckey']:e['contactKey']},i=e['lastServerSideDataRequest']||{},o=i['payload'],a=i['time'],n=i['response'],s=n['status'],d=n['body'];return Ni(r,o)&&d&&s===200&&a+t<=hi()?x[de](e):(e['lastServerSideDataRequest']={['payload']:r,['response']:hi()},Qa(Xi(r))[ue](t=>{var r=t['data']||{},o=t['error'],a=t['status'];return o&&ao(ar('Visitor info get failed, status:',a,' error:',o),['onsite','http'],'warn'),e['tags']=(r['Tags']||[])[ye](e=>S(e)),e['segments']=(r['Segments']||[])[ye](e=>S(e)),e['attributes']=r['Attrs']||{},i['response']={['body']:r,['status']:a},e}))},ps=(t,r)=>(ao('Send subscription to API triggered',['subscription']),is()[ue](o=>{if(t=t||{},r=r||{},!o)return ao('Send subscription to API aborted: Tracking is not permitted',['subscription']),t;var a=t['deviceId'],n=t['pushNotificationSubscription'],s=Oi({['udid']:a,['contactKey']:t['contactKey'],['permission']:t['userPermission'],['trackingPermission']:t['trackingPermission'],['country']:t['country'],['timezone']:bi(),['langugage']:hr(),['advertisingId']:ie,['carrierId']:e,['token']:n['token'],['tokenType']:n['type'],['webSubscription']:dr(n['data']),['integrationKey']:gt,['appVersion']:e,['sdkVersion']:rt},r),d=t['lastSubscriptionRequest'],c=d['payload'];return delete c['referrer'],Ni(s,c)&&d['time']+vi>hi()?(ao('Send subscription to API aborted: Previous subscription request payload is same and request cooldown time in progress',['subscription']),t):Xa(s)[ue](e=>{var r=e['data'],o=e['status'],n=e['error'];return n?(ao(ar('Send subscription to API request failed. status:',o,' error: ',n),['subscription','http'],'warn'),i):(d['payload']=s,d['time']=hi(),d['response']['status']=o,d['response']['result']=r,ao('Send subscription to API request is successful',['subscription','http']),Rn(a,t))})})),ms=(t,r)=>(r=r||'contact_or_device',Ln()[ue](i=>{var o=i['deviceId'],a=i['contactKey'];if(r==='contact'&&!a)return x[de](e);if(!tr(t))return x[de](e);for(var n=0;n<t[ve];n++){var s=t[n];if(!s['tag'])return x[de](e);s['changeTime']&&_i(s['changeTime'])&&(s['changeTime']=fi(s['changeTime'])['toISOString']()),s['removeTime']&&_i(s['removeTime'])&&(s['removeTime']=fi(s['removeTime'])['toISOString']())}return Ya({['key']:r==='device'?o:a||o,['tags']:t,['accountName']:ct})[ue](e=>{if(e&&e['error'])throw e;return e})})),gs=[{[Ee]:'google',[je]:'q',[Ge]:'google.com'},{[Ee]:'yandex',[je]:'text',[Ge]:'yandex.com'},{[Ee]:'bing',[je]:'q',[Ge]:'bing.com'},{[Ee]:'yahoo',[je]:'p',[Ge]:'yahoo.com'},{[Ee]:'about',[je]:'q',[Ge]:'about.com'},{[Ee]:'aol',[je]:'q',[Ge]:'aol.com'},{[Ee]:'ask',[je]:'q',[Ge]:'ask.com'},{[Ee]:'globo',[je]:'q',[Ge]:'globososo.com'},{[Ee]:'go.mail.ru',[je]:'q',[Ge]:'go.mail.ru'},{[Ee]:'go.rambler.ru',[je]:'query',[Ge]:'rambler'},{[Ee]:'tut.by',[je]:'query',[Ge]:'tut.by'}],vs=[{[Ee]:'twitter.com',[Ge]:'t.co'},{[Ee]:'plus.google.com',[Ge]:'plus.url.google.com'}],fs=['source','medium','campaign','content','term'],hs=['cmp','cnt','trm'],ys=['gclid','yclid'],bs={['id']:'sessionId',['date']:'startTime',['pviv']:'pageViewCount',['entry']:'entryURL',['referrer']:'referrerURL',['first']:'isFirst',['gclid']:'advertisingId',['dn_channel']:'dengageChannel',['dn_send_id']:'dengageSendId'},_s=e=>gs[be](t=>e[Ge]===t[Ge]),ws=e=>{var t=[][he](gs,vs)[be](t=>e[Ge]===t[Ge]);return t&&t[Ee]||e[Ge]||''},Ps=()=>{if(!w)return'';var e=Gi(w),t=e[Ge];return t===l||ft[Ne](t)?'':t+e['pathname']},Ss=()=>{var t=Zi(s),r=w?Gi(w):{},i=r[Ge]||ie,o=ws(r),a=_s(r),n=a&&a[je]||ie,c=!!w&&i!==l&&!ft[Ne](i),u=!!a,p=Di(t,fs[ye](e=>'utm_'+e)),m=Di(t,hs[ye](e=>qe+e)),g=Di(t,ys),v=Di(t,['gclid']),f=Di(t,['yclid']),h=p||m||g?'utm':u?'organic':c?'referrer':'typein',y=h==='utm'?t['utm_source']||(v?'google':f?'yandex':e):c?o:e,b=h==='utm'?t['utm_medium']||(g?'cpc':e):h==='organic'?'organic':h==='referrer'?'referrer':e,_=t['utm_campaign']||t['dn_cmp']||(v?'google_cpc':f?'yandex_cpc':e),P=h==='utm'?t['utm_content']||t['dn_cnt']||e:h==='referrer'?r['path']:e,S=h==='utm'?t['utm_term']||(u?t[n]:e):e,N=t['gclid']||t['yclid']||e,I=t['dn_channel']||e,C=t['dn_send_id']||e;return{['entryURL']:d,['referrerURL']:Ps(),['type']:h,['source']:y,['medium']:b,['campaign']:_,['content']:P,['term']:S,['advertisingId']:N,['dengageChannel']:I,['dengageSendId']:C}},Ns=(e,t)=>['deviceId','type','source','medium','campaign','content','term','advertisingId','dengageChannel','dengageSendId'][Se](i=>i==='type'&&e[i]==='typein'?r:e[i]===t[i]),Is=(t,r)=>{var o=hi();return Oi({['sessionId']:Ja(),['deviceId']:r,['startTime']:o,['endTime']:o+30*mi,['pageViewCount']:0,['entryURL']:d,['referrerURL']:Ps(),['isFirst']:i,['type']:e,['source']:e,['medium']:e,['campaign']:e,['content']:e,['term']:e,['advertisingId']:e,['dengageChannel']:e,['dengageSendId']:e},t)},Cs=e=>(e['endTime']=hi()+30*mi,e),ks=e=>{var t=e['deviceId'],r={['session_id']:e['sessionId'],['utm_source']:e['source'],['utm_medium']:e['medium'],['utm_campaign']:e['campaign'],['utm_content']:e['content'],['utm_term']:e['term'],['referrer']:e['referrerURL'],['gclid']:e['advertisingId'],['channel']:e['dengageChannel'],['send_id']:e['dengageSendId'],['app_guid']:mt};return as('session_info',t,r)},Ts=e=>wi(e)[we]((t,r)=>{var i=e[r];return t[bs[r]||r]=i,t},{}),xs=(e,t,r,i,o)=>x[le]([Sn(),In()])[ue](a=>{var n=a[0]||'',s=a[1]||'';return i&&(i['path']=ar('websdk/',st,'/',mt,'/',i['path']||''),i['queryParams']=Xi(Oi({['userAgent']:g,['parsedUserAgent']:dr(co()),['sdkVersion']:rt,['deviceId']:n,['contactKey']:s},i['queryParams']||{}))),ao(e,t,r,i,o)}),Ds=xr*pi,Os=Dr*pi,Es=(e=>{for(var t=0;e>=0;){if((e-=Os*t)<=0)return t;t++}return t})(Ds),As=['dengage_webpush_token','dengage_webpush_token_type','dengage_webpush_sub','dengage_user_permission','dengage_webpush_last_a','dengage_webpush_last_d','dengage_push_blocked_count','dengage_push_blocked_last_d','dengage_onsite_messages','dengage_onsite_last_created','dengage_onsite_get_message_timestamp','next_onsite_message_display_time','dengage_tracking_permission','dengage_country','dengage_log_level'],Ls=['dengage_device_id','dengage_contact_key','dn_legacy_onsite'],Rs=['dn_webpush','dn_legacy_onsite','dn_onsite_display_infos','dn_extra','dn_visits','dn_session','dn_visitor_info','dn_story_set_visits','dn_last_subs_time'],Fs=e=>[][he](As,Ls,e?[]:Rs),Ms=()=>Lo('_dn_sid'),Vs=e=>{var t=Fs(e);return x[le](t[ye](e=>Bo(e)[pe](e=>null)))[ue](e=>t[we]((t,r,i)=>(t[r]=e[i],t),{}))},Ks=e=>{var t=Fs(e);return x[le](t[ye](e=>Ho(e)))},Bs=e=>{var t='-999px',r=Li('iframe',{[Oe]:'dengage-cross-frame-storage',['src']:e},[['display','none','important'],['position','fixed','important'],['top',t,'important'],['left',t,'important']]);return Ri(r),r},zs=()=>{var t=Bs(xo),o=Gi(xo)['origin'],s=i,d=0,c=e;return nr((e,i)=>{if(!n['domain'])return ao('Cross-frame storage initialization aborted: iframe injection does not allowed',['storage','migration','crossFrame'],'warn'),e({});var l='migration',u=Y(()=>(ao('Cross-frame storage initialization aborted: Request Timeout('+xr+' seconds)',['storage','migration','crossFrame'],'warn'),e({})),Ds),p=e=>{d>Es||s?Q(c):(t['contentWindow']['postMessage'](e,'*'),c=Y(()=>{d++,p(e)},d*Os))},m=t=>{var i=t['origin'];if(o==i){var n=sr(t['data']),d=n['id'],p=n['response'];if(d===l){if(Q(u),Q(c),!s)return s=r,e(p);Mi(a,'message',m)}}};Fi(a,'message',m),p(l)})},Ws=()=>x[le]([Ms()||'',Vs(wt)[pe](e=>(ao('Get V1 Local Storage Data error: '+dr(e),['storage','migration'],'warn'),{})),wt?zs()[pe](e=>(ao('Get V1 Cross-frame Storage Data error: '+dr(e),['storage','migration'],'warn'),{})):{}])[ue](e=>{var t=e[0]||ie,r=e[1]||{},o=e[2]||{},a=Oi({['cookieSessionId']:t},o,r),n=r['dn_legacy_onsite']||{['get_message_t']:r['dengage_onsite_get_message_timestamp']||0,['last_msg_created']:r['dengage_onsite_last_created']||0,['messages']:r['dengage_onsite_messages']||[]},s=o['dn_legacy_onsite']||{},d=[][he](n['messages']||[],s['messages']||[]),c={};a['dn_legacy_onsite']={['last_msg_created']:U(n['last_msg_created']||0,s['last_msg_created']||0,r['dengage_onsite_last_created']||0,0),['get_message_t']:U(n['get_message_t']||0,s['get_message_t']||0,r['dengage_onsite_get_message_timestamp']||0,0),['messages']:[]};for(var l=0;l<d[ve];l++){var u=d[l],p=c[u[Oe]];(!p||u['endDate']>p['endDate'])&&(c[Oe]=u)}a['dn_legacy_onsite']['messages']=Pi(c);for(var m=[][he](r['dn_onsite_display_infos']||[],o['dn_onsite_display_infos']||[]),g={},v=0;v<m[ve];v++){var f=m[v],h=g[f[Oe]];h?(h['displayCount']+=f['displayCount'],h['isClicked']=!!(f['isClicked']+h['isClicked']),h['lastDisplayTime']=U(f['lastDisplayTime'],h['lastDisplayTime'],0)):g[f[Oe]]=f}return a['dn_onsite_display_infos']=Pi(g),a['dn_webpush']||(a['dn_webpush']={['token']:a['dengage_webpush_token']||ie,['type']:a['dengage_webpush_token']||ie,['sub']:a['dengage_webpush_sub']||ie,['user_perm']:a['dengage_user_permission']||i,['prompt_last_a']:a['dengage_webpush_last_a']||ie,['prompt_last_t']:a['dengage_webpush_last_d']||0,['blocked_prompt_count']:a['dengage_push_blocked_count']||0,['blocked_prompt_last_t']:a['dengage_push_blocked_last_d']||0}),a['dn_webpush']['prompt_last_a']=a['dn_webpush']['prompt_last_a']==='ask'?'default':a['dn_webpush']['prompt_last_a'],a['dn_extra']||(a['dn_extra']={['tracking_perm']:a['dengage_tracking_permission']||i,['country']:a['dengage_country']||ie,['last_cat']:ie,['last_visit']:0,['next_onsite_message_t']:a['next_onsite_message_display_time']||0,['log_level']:a['dengage_log_level']||'error',['debug']:a['dn_debug']||i}),a})[pe](e=>(ao('Get V1 Storage Data error: '+dr(e),['storage','migration'],'warn'),{})),Hs=()=>(ao('V1 SDK storage migration is started',['storage','migration']),Ws()[ue](t=>{var o=t['dengage_device_id']||t['dn_device_id'],a=t['dengage_contact_key']||t['dn_contact_key'];if(!o&&!a)return ao('V1 SDK storage migration is canceled, since no V1 storage data on browser',['storage','migration']),Dn(r);var n=t['cookieSessionId'],s=t['dn_session'];return x[le]([An(o),Fn(a)])[ue](r=>{var[i,d]=r,c=[],l=i&&i['deviceId']||d&&d['deviceId']||o||Ja(),u=i&&i['contactKey']||d&&d['contactKey']||a||'',p=i||ds(l,u);if(s){var m=Ts(s),g=m['sessionId'];m['deviceId']=l,m['endTime']=(n===g?m['startTime']:hi())+30*mi,c[fe](()=>Bn(g,Is(m)))}p['contactKey']&&c[fe](()=>Mn(u,{['contactKey']:p['contactKey'],['deviceId']:p['deviceId']})),p['lastSubscriptionRequest']['time']=U(p['lastSubscriptionRequest']['time'],t['dn_last_subs_time']||0),p['lastServerSideDataRequest']['time']=U(p['lastServerSideDataRequest']['time'],t['last_request_time']||0);var v=t['dn_webpush'],f=p['pushNotificationSubscription'];f['token']=f['token']||v['token']||ie,f['type']=f['type']||v['type']||ie,f['data']=f['data']||sr(v['sub'])||e;var h=p['pushNotificationPermissionPrompts'],y={['default']:'',['denied']:'refuse',['granted']:'accept'};h['lastPromptDisplayTime']=U(h['lastPromptDisplayTime']||0,v['prompt_last_t']||0,0),h['lastNativePromptResponse']=h['lastNativePromptResponse']||v['prompt_last_a']||ie,h['lastCustomPromptResponse']=h['lastCustomPromptResponse']||y[v['prompt_last_a']]||ie,h['blockedInfoDisplayCount']=(h['blockedInfoDisplayCount']||0)+(v['blocked_prompt_count']||0),h['lastBlockedInfoDisplayTime']=U(h['lastBlockedInfoDisplayTime']||0,v['blocked_prompt_last_t']||0,0);var b=t['dn_extra']||{};p['country']=b['country']||p['country']||ie,p['trackingPermission']=er(b['tracking_perm'])?b['tracking_perm']:p['trackingPermission'],p['userPermission']=er(v['user_perm'])?v['user_perm']:p['userPermission'],p['lastVisitedPageCategory']=b['last_cat']||ie,p['lastVisitTime']=U(b['last_visit']||0,p['lastVisitTime'],0),p['totalPageViewCount']=(b['pview']||0)+z(p['totalPageViewCount']),p['totalSessionCount']=(b['visit']||0)+z(p['totalSessionCount']);for(var _=t['dn_visits']||[],w=p['visitsByDay']||[],P={},S=0;S<w[ve];S++)P[w[S]['day']]=S;for(var N=0;N<_[ve];N++){var I=_[N],[C,k,T]=I,D=P[C];D>=0?w[D]['pageView']+=T:w[fe]({['day']:C,['pageView']:T})}for(var O=t['dn_onsite_display_infos'],E=p['onsiteMessageHistories'],A=0;A<O[ve];A++){var L=O[A],R=L['id'];E[R]||(E[R]=[]);for(var F=0;F<L['displayCount'];F++)E[R][fe]({['displayTime']:L['lastDisplayTime']-F*mi,['isClicked']:L['isClicked']})}var M=t['dn_story_set_visits'],V=p['storySetVisits'];M&&(p['storySetVisits']=wi(M)[we]((e,t)=>{var r=e[t];return e[t]=r?M[t][we]((e,t)=>(e[Ne](t)||e[fe](t),e),r):M[t],e},V));var K=t['dn_legacy_onsite']||{},B=K['get_message_t']||0,W=K['last_msg_created']||0,H=K['messages']||[],q=p['flowOnsite'];q['lastGetTime']=U(B,q['lastGetTime']),q['mostRecentMessageCreateTime']=U(W,q['mostRecentMessageCreateTime']);for(var G=function e(){var t=H[j],r=t['id'],i=t['contactKey'];i===u&&q['messageIds'][fe](r),c[fe](()=>qn(r,{['id']:r,['recipientVisitors']:[{['deviceId']:l,['contactKey']:i}],['data']:t['messageObj']}))},j=0;j<H[ve];j++)G();return c[fe](()=>Rn(l,p),()=>Nn(l),()=>Cn(u),()=>En(b['debug'])),x[le](c[ye](e=>e()))})[ue](e=>{var t=e[_e](e=>e===i),r=t[ve];if(t[ve])throw ar('storage requests has ',r,' error(s)');return Ks(wt)})[ue](e=>(ao('V1 SDK storage is migrated succesfully',['storage','migration']),Dn(r)))})[pe](e=>(xs(ar('V1 SDK storage migration error: ',e),['storage','migration'],'error',{['path']:'storage-migration-error',['queryParams']:{['error']:dr(e)}},r),i))),Us=e=>zi(ar(Xt,Yr,e,'.html.js'),'__dn_onsite_push_custom_prompt__'),qs=e=>zi(ar(Xt,Qr,e,'.html.js'),'__dn_onsite_push_block_info__');function Gs(t){var r=this;r['configuration']=t,r['subscription']=e,r['isSupported']=()=>!!a['safari']&&!!a['safari']['pushNotification']&&!!a['Notification'],r['getPermissionObject']=()=>{if(!r['isSupported']())return{};var e=a['safari']['pushNotification']['permission'](r['configuration']['websitePushID']);return r['subscription']=e['deviceToken'],e},r['permission']=()=>r['getPermissionObject']()['permission'],r['getSubscription']=()=>r['getPermissionObject']()['deviceToken'],r['requestPermission']=()=>nr((e,t)=>{var i=r['permission'](),o=r['subscription'];if(!r['isSupported']())return addLog('Push Notifications are not supported, permission request aborted',['pushNotification','safari'],'warn'),t({['permission']:i,['subscription']:o});if(i==='default')try{a['safari']['pushNotification']['requestPermission'](r['configuration']['webServiceUrl'],r['configuration']['websitePushID'],r['configuration']['getUserData'](),t=>{e({['permission']:t['permission'],['subscription']:t['deviceToken']})})}catch(t){e({['permission']:i,['subscription']:o})}else e({['permission']:i,['subscription']:o})})}function js(t){var o=this;o['configuration']=t,o['registration']=e,o['subscription']=e,o['isSupported']=()=>{try{return!!(m['serviceWorker']&&a['PushManager']&&a['Notification']&&m['permissions'])}catch(e){return i}},o['permission']=()=>o['isSupported']()?P['permission']:e,o['registerServiceWorker']=()=>{if(!o['isSupported']())return ao('Push Notifications are not supported, Service Worker registration aborted',['pushNotification','serviceWorker'],'warn'),x['reject'](e);if(o['registration'])return x['resolve'](o['registration']);var r=t['url'];try{r=Gi(r)}catch(e){r=Gi(r,c)}return t['isAddQueryParamsToSWEnabled']&&(r=ji($i(r,{['account_id']:st,['app_guid']:mt,['domain']:Z(bo['script']['domain'])}))),m['serviceWorker']['register'](r,{['scope']:t['scope'],['updateViaCache']:'none'})[ue](e=>nr(t=>{if(e['active'])return t(e);var r=e['installing']||!e['waiting'];if(!r)return t(e);r['addEventListener']('statechange',()=>{r['state']==='activated'&&t(e)})}))[pe](t=>e)},o['subscribe']=()=>o['registerServiceWorker']()[ue](e=>e['pushManager']['subscribe']({['userVisibleOnly']:r,['applicationServerKey']:t['vapidPublicKey']}))[ue](e=>(o['subscription']=e,e))[pe](t=>(t&&t['name'],e)),o['unsubscribe']=()=>o['subscription']?o['subscription']['unsubscribe']()[ue](()=>(o['subscription']=e,e))[pe](t=>e):x['resolve'](e),o['getSubscription']=o['subscribe'],o['requestPermission']=()=>o['getSubscription']()[ue](e=>e&&qa(Ga(e['options']['applicationServerKey']))!==qa(t['vapidPublicKey'])?o['unsubscribe']()[ue](()=>o['subscribe']()):e)[ue](t=>({['permission']:o['permission'](),['subscription']:t?Ii(t):e}))[pe](e=>({['permission']:o['permission'](),['subscription']:o['subscription'],['error']:e}))}var Js=200,Zs="#dengage_push-accept-button",Xs="#dengage_push-refuse-button",Ys=200;function Qs(t){var o=this,n=e;n=t['isSafari']&&!m['serviceWorker']?new Gs(t['safari']):new js(t['serviceWorker']),o['configuration']=t;var s=t['customPromptContainerEl'],d=t['blockedInfoContainerEl'];o['customPromptContainerEl']=e,o['isCustomPromptBeingDisplayed']=i,o['isCustomPromptClickable']=i,o['blockedInfoContainerEl']=e,o['isBlockedInfoBeingDisplayed']=i,o['isBlockedInfoClickable']=i,o['isSupported']=n['isSupported'],o['permissionStatus']=n['permission'],o['subscription']=n['getSubscription'],o['showNativePrompt']=()=>{if(!o['isSupported'])return ao('Push Notifications are not supported, native permission prompt cannot be displayed',['pushNotification','nativePrompt'],'warn'),x['reject']({});var e=o['permissionStatus']();return n['requestPermission']()[ue](t=>{var i=o['permissionStatus']();return Dt&&e==='default'&&i==='granted'&&Y(()=>{var e=new Notification(Ot['title'],{['body']:Ot['message'],['requireInteraction']:r}),t=Ot['link'];t&&(e['onclick']=e=>{var r=e['notification'];r&&ir(r['close'])&&(ao('Welcome Notification is closed',['pushNotification','welcomeNotification']),r['close']()),a['open'](t),ao('Welcome Notification is clicked',['pushNotification','welcomeNotification'])}),ao('User granted Push Notification Permission for the first time, Welcome Notification is displayed',['pushNotification'])},500),t})},o['showCustomPrompt']=e=>nr((t,i)=>{if(!o['isSupported'])return ao('Push Notifications are not supported, custom permission prompt cannot be displayed',['pushNotification','customPrompt'],'warn'),i('abort');if(o['isCustomPromptBeingDisplayed'])return ao('Custom Permission Prompt display aborted: Prompt is already being displayed',['pushNotification','customPrompt'],'warn'),t('abort');if(!s||!s['cloneNode'])return ao('Custom Permission Prompt cannot be displayed: HTML is not available',['pushNotification','customPrompt'],'warn'),t('error');o['customPromptContainerEl']=s['cloneNode'](r),o['isCustomPromptClickable']=r;var a=o['customPromptContainerEl']['querySelector'](Zs);a&&Fi(a,'click',()=>{o['isCustomPromptClickable']&&(ao('Custom Permission Prompt is accepted',['pushNotification','customPrompt']),t('accept'),o['hideCustomPrompt']())});var n=o['customPromptContainerEl']['querySelector'](Xs);n&&Fi(n,'click',()=>{o['isCustomPromptClickable']&&(ao('Custom Permission Prompt is refused',['pushNotification','customPrompt']),t('refuse'),o['hideCustomPrompt']())}),Ri(o['customPromptContainerEl'],b),o['isCustomPromptBeingDisplayed']=r,Y(()=>{ao('Custom Permission Prompt is displayed',['pushNotification','customPrompt']),o['customPromptContainerEl']['classList']['add']('_dn_show'),e()})}),o['hideCustomPrompt']=()=>{o['isCustomPromptBeingDisplayed']?(o['isCustomPromptClickable']=i,o['customPromptContainerEl']['classList']['remove']('_dn_show'),Y(()=>{o['customPromptContainerEl']['remove'](),o['isCustomPromptBeingDisplayed']=i,ao('Custom Permission Prompt is closed',['pushNotification','customPrompt'])},Js)):ao('Closing Custom Permission Prompt is aborted: Prompt is already closed',['pushNotification','customPrompt'],'warn')},o['showBlockedInfoPopup']=()=>nr(e=>o['isSupported']?o['isBlockedInfoBeingDisplayed']?(ao('Push Notification Blocked Info display is aborted: Popup is already being displayed',['pushNotification','blockedInfo'],'warn'),e('abort')):d&&d['cloneNode']?(o['blockedInfoContainerEl']=d['cloneNode'](r),Ri(o['blockedInfoContainerEl'],b),o['isBlockedInfoBeingDisplayed']=r,Y(()=>{o['blockedInfoContainerEl']['classList']['add']('_dn_show')}),o['isBlockedInfoClickable']=r,Fi(o['blockedInfoContainerEl'],'click',o['hideBlockedInfoPopup']),void e('display')):(ao('Push Notification Blocked Info cannot be displayed: HTML is not available',['pushNotification','blockedInfo'],'warn'),e('error')):(ao('Push Notifications are not supported, permission blocked info cannot be displayed',['pushNotification','blockedInfo'],'warn'),e('abort'))),o['hideBlockedInfoPopup']=()=>{o['isBlockedInfoBeingDisplayed']?(o['isBlockedInfoClickable']=i,o['blockedInfoContainerEl']['classList']['remove']('_dn_show'),Y(()=>{o['blockedInfoContainerEl']['remove'](),o['isBlockedInfoBeingDisplayed']=i,ao('Push Notification Blocked Info is closed',['pushNotification','blockedInfo'])},Ys)):ao('Closing Push Notification Blocked Info is aborted, already closed',['pushNotification','blockedInfo'],'warn')}}var $s='#dengage-push-prompt-style',ed='#dengage-push-prompt-container',td='#dengage-blocked-push-info-style',rd='#dengage-blocked-push-info-container',id="#dengage-blocked-push-info-image",od=e,ad=e,nd=e,sd=()=>'serviceWorker'in m&&'PushManager'in a,dd=(t,r,i)=>{if(nd)return ao('Push Notification resources already prepared',['pushNotification','resources'],'warn'),x[de](nd);var o=(Mt||[])[be](e=>(e['language']||'')===r),a=o?o['language']:Ft,n=(Ht||[])[be](e=>(e['language']||'')===r),s=n?n['language']:Wt;return x[le]([Us(a)[ue](e=>e['data']),Vt?qs(s)[ue](e=>e['data']):e])[ue](e=>{var[r,o]=e;if(r){var a=Ei(r),n=a['querySelector']($s);od=a['querySelector'](ed),Ri(n,y)}else ao('Push Notification custom prompt html is not available',['pushNotification','resources'],'warn');if(Vt)if(o){var s=Ei(o),d=s['querySelector'](td);(ad=s['querySelector'](rd))['querySelector'](id)['src']=ar('https://cdn.dengage.com/internal/','chrome','.png'),Ri(d,y)}else ao('Push Notification blocked info html is not available',['pushNotification','resources'],'warn');var c=(i=i||{})['url']||It,l=i['scope']||Ct,u=i['isAddQueryParamsToSWEnabled'];return nd=new Qs({['customPromptContainerEl']:od,['blockedInfoContainerEl']:ad,['isSafari']:uo()==='Safari'&&!sd(),['serviceWorker']:{['url']:c,['scope']:l,['isAddQueryParamsToSWEnabled']:u,['vapidPublicKey']:vt},['safari']:{['webServiceUrl']:pt,['websitePushID']:kt,['getUserData']:()=>({['device_id']:t()})}}),ao('Push Notification resources prepared',['pushNotification','resources']),nd})},cd=e=>Nt?(ao('Push Notification initialize triggered',['pushNotification']),nd&&ld()?ud()==='granted'?(ao('Push Notification permission is already "granted"',['pushNotification','permission']),pd()[ue](t=>hd(e,t))):(ao('Push Notification is initialized',['pushNotification']),hd(e)):(ao('Push Notification is not supported',['pushNotification'],'warn'),x[de](e))):x[de](e),ld=()=>nd&&nd['isSupported']()||i,ud=()=>nd&&nd['permissionStatus']()||'default',pd=()=>nd&&nd['subscription']()||e,md=(e,t)=>nd&&ld()?(ao('Requesting Push Notification Permission from user started',['pushNotification','permission']),nr(i=>{var o=ud(),a=e['pushNotificationPermissionPrompts']||{};if(o==='granted')return ao('Requesting Push Notification Permission from user is aborted: Permission is already "granted"',['pushNotification','permission']),a['lastNativePromptResponse']='granted',pd()[ue](t=>hd(e,t))[ue](i);if(o==='denied'){if(a['lastNativePromptResponse']='denied',ao('Requesting Push Notification Permission from user is aborted: Permission is already "denied"',['pushNotification','blockedInfo']),Vt){ao('"Display Push Notification Blocked Info" feature is enabled, checking show conditions',['pushNotification','blockedInfo']);var n=a['blockedInfoDisplayCount']||0,s=a['lastBlockedInfoDisplayTime']||0,d=hi()-s,c=zt*gi;if(Bt<n)ao(ar('Displaying Push Notification Blocked Info is aborted: Maximum display limit reached. Max: ',Bt,' Current: ',n),['pushNotification','blockedInfo']);else{if(!(d<c))return Y(()=>{i(fd(e))},(Kt||0)*pi);ao(ar('Displaying Push Notification Blocked Info is aborted: Minimum wait time to reshow has not expired. Minimum time to next display ',j((c-d)/mi),' minutes'),['pushNotification','blockedInfo'])}}return pd()[ue](t=>i(hd(e,t)))}var l=e['totalSessionCount']||0;if(At>l)return ao(ar('Requesting Push Notification Permission from user is aborted: Minimum session count to ask Push Notification permission is not met. Min: ',At,', Current: ',l),['pushNotification','permission']),i(e);var u=a['lastCustomPromptResponse']||'',p=a['lastPromptDisplayTime']||0,m=hi()-p,g=(Lt||0)*mi,v=(Rt||0)*mi;return u==='refuse'&&m<=g?(ao(ar('Requesting Push Notification Permission from user is aborted: Last custom prompt is refused, Minimum wait time to reshow has not expired. Minimum time to next display ',j((g-m)/mi),' minutes'),['pushNotification','customPrompt']),i(e)):['ignore','accept'][Ne](u)&&m<=v?(ao(ar('Requesting Push Notification Permission from user is aborted: Last custom prompt is ignored, Minimum wait time to reshow has not expired. Minimum time to next display ',j((v-m)/mi),' minutes'),['pushNotification','customPrompt']),i(e)):Y(Tt?()=>{ao('"Can Show Native Prompt if Allowed" feature is enabled, triggering Native Permission Prompt',['pushNotification','nativePrompt']),i(vd(e,r,t))}:()=>{ao('"Can Show Native Prompt if Allowed" feature is disabled, triggering Custom Permission Prompt',['pushNotification','nativePrompt']),i(gd(e,t))},(Et||0)*pi)})):(ao('Push Notification is not supported',['pushNotification'],'warn'),x[de](e)),gd=(t,r)=>{if(!Nt)return e;ao('Custom Permission Prompt display is triggered',['pushNotification','customPrompt']);var o=t['pushNotificationPermissionPrompts']||{};return ud()==='granted'?(ao('Custom Permission Prompt display is aborted: Push Notification Permission is already "granted"',['pushNotification','customPrompt']),pd()[ue](e=>hd(t,e))):nd['showCustomPrompt'](()=>{r&&ir(r)&&(o['lastPromptDisplayTime']=hi(),o['lastCustomPromptResponse']='ignore',r(t))})[ue](e=>(o['lastCustomPromptResponse']=e,r&&ir(r)&&r(t),e==='accept'?vd(t,i,r):hd(t)))},vd=(t,r,i)=>{if(!Nt)return e;ao('Native Permission Prompt display is triggered',['pushNotification','nativePrompt']);var o=hi(),a=t['pushNotificationPermissionPrompts']||{},n=ud();return nd['showNativePrompt']()[ue](e=>{var s=e['permission'];if(s==='granted'&&s===n)return ao('Native Permission Prompt is aborted: Push Notification Permission is already "granted"',['pushNotification','nativePrompt']),hd(t,e['subscription']);var d=hi();return n!=='granted'&&s===n&&d-o<100?(ao(ar('Native Permission Prompt is aborted: Direct display is blocked by browser'),['pushNotification','nativePrompt']),r?gd(t,i):t):(ao(ar('Native Permission Prompt responded, response: ',s),['pushNotification','nativePrompt']),a['lastPromptDisplayTime']=o,a['lastNativePromptResponse']=s,hd(t,e['subscription']))})},fd=t=>{if(!Nt)return e;var r=t['pushNotificationPermissionPrompts']||{},i=r['blockedInfoDisplayCount'];return nd['showBlockedInfoPopup']()[ue](()=>(ao('Push Notification Blocked Info displayed',['pushNotification','blockedInfo']),r['blockedInfoDisplayCount']=i+1,r['lastBlockedInfoDisplayTime']=hi(),t))},hd=(t,r)=>{var i=t['pushNotificationSubscription']||{};return r?(i['data']=Ii(r),i['domain']=l,i['type']=uo()!=='Safari'||sd()?'W':'S',yd(r)[ue](e=>(i['token']=e,t))):(i['data']=e,i['domain']='',i['type']='',i['token']='',x[de](t))},yd=e=>{var t=dr(e)[me](/[^ -~]+/g,ie);return Za(t)[ue](e=>'dn_'+e)};function bd(e,t){var r=0;return function(){var i=hi();i-r>=t&&(r=i,e['apply'](this,or(arguments)))}}var _d=0,wd=(e,t,i)=>{if(e==='NAVIGATION')Fi(a,'dengageNavigation',()=>{Y(()=>{i()},t)});else if(e==='ON_SCROLL'){var o=bo['scrollBreakPoints']||[];o[fe](t),bo['isScrollListenerAdded']||(Fi(a,'scroll',bd(()=>{if(!bo['isScrollListenerBlocked']){var e=z(a['scrollY']/(b['scrollHeight']-a['innerHeight']||1)*100),t=e-_d;if(t>0&&(e>=100-Rr||!(t<Rr))){_d=e;for(var n=bo['nextScrollBreakPointIndex'];n<o[ve];n++)if(e>=o[n]&&n>=bo['nextScrollBreakPointIndex']){bo['nextScrollBreakPointIndex']=n+1,bo['isScrollListenerBlocked']=r,i();break}}}},Fr)),bo['isScrollListenerAdded']=r)}else if(e==='DATA_LAYER_EVENT'){var n=bo['dataLayerTriggerEventNames']||[];n[fe](t),Mo(),Fo(function(){var e=or(arguments);for(var t of n)for(var r of e)r&&r['event']===t&&i()})}else['DENGAGE_EVENT','CUSTOM_EVENT'][Ne](e)?Fi(a,t,e=>{i()}):e==='EXIT_INTENT'&&Fi(f,'mouseleave',e=>{e['clientY']<-20&&i()});return{[e]:t}},Pd=e=>{for(var t={},r=0;r<e[ve];r++){var i=e[r],o=i['triggerSettings'],a=o['triggerBy'],n='';a==='NAVIGATION'&&(n=o['delay']*pi),a==='ON_SCROLL'&&(n=o['scrollPercentage']),['DATA_LAYER_EVENT','DENGAGE_EVENT','CUSTOM_EVENT'][Ne](a)&&(n=o['eventName']),a==='EXIT_INTENT'&&(n='top'),t['hasOwnProperty'](a)||(t[a]={}),t[a]['hasOwnProperty'](n)||(t[a][n]=[]),t[a][n][fe](i['publicId'])}return x[de](t)},Sd=e=>(Nd(e),x[de](e)),Nd=e=>{var t=(rr(e)?e[Ee]:e)||ie;ao(ar('Navigation triggered',t?' with page category: '+t:''),['navigation','trigger']),Ln()[ue](t=>{if(t){var r=new T('dengageNavigation');r['pageCategory']=e||ie,a['dispatchEvent'](r);var i=yi(),o=t['visitsByDay']||[],n=o[0]||{};return n['day']===i?n['pageView']=pr(n['pageView'])+1:o['unshift']({['day']:i,['pageView']:1}),t['totalPageViewCount']=pr(t['totalPageViewCount'])+1,t['lastVisitedPageCategory']=e||ie,Rn(t['deviceId'],t)[ue](e=>cd(t)[ue](e=>An(e['deviceId'])[ue](t=>(t['pushNotificationPermissionPrompts']=Oi(t['pushNotificationPermissionPrompts'],e['pushNotificationPermissionPrompts']),t['pushNotificationSubscription']=Oi(t['pushNotificationSubscription'],e['pushNotificationSubscription']),x[le]([Rn(t['deviceId'],t),ps(t)])[ue](e=>t)))[ue](e=>Nt?xt?md(e,e=>{var t=e['deviceId'];return An(t)[ue](r=>(r['pushNotificationPermissionPrompts']=Oi(r['pushNotificationPermissionPrompts'],e['pushNotificationPermissionPrompts']),r['pushNotificationSubscription']=Oi(r['pushNotificationSubscription'],e['pushNotificationSubscription']),Rn(t,r)[ue](()=>r)))}):(ao('"Show Push Prompt on Navigation" feature is not enabled',['pushNotification','permission']),e):e))[ue](e=>An(e['deviceId'])[ue](t=>(t['pushNotificationPermissionPrompts']=Oi(t['pushNotificationPermissionPrompts'],e['pushNotificationPermissionPrompts']),t['pushNotificationSubscription']=Oi(t['pushNotificationSubscription'],e['pushNotificationSubscription']),x[le]([Rn(t['deviceId'],t),ps(t)])))))}ao('No active visitor',['visitor','navigation'])})},Id=t=>{if(bo['isInstalled']){if(!bo['isInitialized']){var o=(t=t||{})['pageCategory']||{},a=t['isDebugMode']||d['includes']('dn_debug=true')||i;return a&&ao('SDK is working on debug mode',['initialize','debug']),oo(a?'info':t['logLevel']||eo['printToConsoleLevel']||bt||'error'),En(a)[ue](()=>ht?(ao('Data sync between domains is enabled, sync process started',['dataSync']),rs()):[])[ue](e=>{var r=[],i=e[0]||{};if(i&&i['deviceId']){var a=i['deviceId'],n=i['contactKey'];ao('Visitor data for sync between domains is found, syncing storage',['dataSync']),r[fe](An(a)[ue](e=>(e||(e=ds(a,n,i)),Rn(a,Oi(e,i)))))}var s=e[1];s&&(ao('Session data for sync between domains is found, syncing storage',['dataSync']),r[fe](Bn(s['sessionId'],s)));var d=t['deviceId']||i['deviceId']||'',c=t['contactKey']||i['contactKey']||'';return r[fe](ss(d,c,o)),x[le](r)})[ue](()=>Ln())[ue](i=>{if(!i)throw'active visitor process has an uncaught error';var o=i['deviceId'],a=t['useSwQueryParams'],n=bo['script']['parameters'],s=n['useSwQueryParams'],d={['url']:t['swUrl']||n['swUrl']||'',['scope']:t['swScope']||n['swScope']||'',['isAddQueryParamsToSWEnabled']:er(a)?a:er(s)?s:r};return ao(ar('Active visitor set, deviceId: ',i['deviceId'],', contactKey: ',i['contactKey']),['initialize']),x[le]([Nt?dd(Sn,hr(),d):e,ps(i),Cd(i),Dd(o)[ue](e=>(e['pageViewCount']<=1&&(i['totalSessionCount']=pr(i['totalSessionCount'])+1),Rn(o,i)))])})[ue](e=>{var t=e[2];return Nt&&ao('Push Notification Helper installed',['initialize','pushNotification']),ao(ar('Onsite messages loaded and sorted, message count: ',t[ve]),['initialize','onsite']),bo['onsiteMessages']=t[we]((e,t)=>Oi(e,{[t['publicId']]:t}),{}),Pd(t)})[ue](e=>(ao('Onsite message triggers collected',['initialize','onsite','trigger']),Td(e)))[ue](e=>{if(ao('Listening onsite message triggers',['initialize','onsite','trigger']),bo['onsiteMessageTriggerListeners']=e,bo['isInitialized']=r,St)return ao('Trigger navigation on install enabled, navigation triggered ',['initialize','trigger']),Sd(o)})[pe](e=>{xs(ar('SDK initialize error: ',e),['initialize'],'error',{['path']:'initialize-error',['queryParams']:{['data']:dr(t),['error']:e}},r)})}ao('"initialize" already completed',['initialize'],'warn')}else ao('"initialize" triggered before SDK install',['install','initialize'],'warn')},Cd=t=>{if(!Do)return x[de]([]);var o=t['deviceId'],a=t['contactKey'],n=t['flowOnsite'],s=n['messageIds']||[];return On()[ue](e=>{var t=n['lastGetTime'],r=qt*mi,i=e||hi()-t>r;return ao(ar('Flow Onsite messages is',i?'':' not',' refetchable',i?'':'. Earliest refetch time: '+fi(t+r)['toISOString']()),['onsite','http']),x[le]([i?Po(o,a)[ue](e=>{var t=e['error'];return t&&ao(ar('Flow onsite messages get request failed, status:',e['status'],' error:',t),['onsite','flow','http'],'warn'),n['lastGetTime']=hi(),e['data']||[]}):[],Hn(),Oo?So(e)[ue](e=>{var t=e['error'];return t&&ao(ar('Realtime messages get request failed, status:',e['status'],' error:',t),['onsite','realtime','http'],'warn'),e['data']||[]}):[]])})[ue](a=>{var[d,c,l]=a;ao(ar('Flow messages from backend: ',(d||[])[we]((e,t,r)=>ar(e,r!=0?',':'',t['smsg_id']),'')||'none'),['onsite','flow']),bo['realtimeOnsiteMessages']=l[ye](e=>Oi(e,{['isRealtime']:r,['messageDetails']:ie}));for(var u=[],p=[],m=[],g=0;g<d[ve];g++){var v=d[g],f=hi(v['created']),h=hi(v['expireDate']);if(!(f<=n['mostRecentMessageCreateTime']||h<=hi())){u[fe](f);for(var y=v['smsg_id'],b=v['message_json'],_=$t(b)?sr(b):b,w=ya(Oi(v,_)),P=i,S=0;S<c[ve];S++)if(!p[Ne](S)){var N=c[S],I=N[Oe],C=N['recipientVisitors'];y===I&&(N['data']=w,C[Ne](o)||N['recipientVisitors'][fe](o),m[fe](N),P=r,p[fe](S))}s[Ne](y)||s[fe](y),P||m[fe]({[Oe]:y,['recipientVisitors']:[o],[Ae]:w})}}var k=(c||[])[we]((e,t)=>{var r=t[Oe];return t['data']&&hi(t['data']['endDate'])<=hi()&&(n['messageIds']=s[_e](e=>e!==r),e[fe](r)),e},[]);return n['mostRecentMessageCreateTime']=U['apply'](e,u),ao('Flow Onsite messages merged',['onsite','flow']),x[le]([][he](Rn(o,t),m[ye](e=>qn(e[Oe],e)),k[ye](e=>Gn(e))))})[ue](()=>(ao('Flow Onsite messages stored',['onsite','flow']),x[le]([jn(o),bo['realtimeOnsiteMessages']])))[ue](e=>_a(e['flat']()))},kd=e=>Ln()[ue](t=>{for(var r=bo['onsiteMessages'],o=[],a=i,n=0;n<e[ve];n++){var s=r[e[n]];o[fe](s),a||(a=sa(s))}return x[le]([o,a?us(t):t,Kn(),{['permission']:ud(),['isSupported']:ld()}])}),Td=e=>{for(var t=[],r=wi(e),i=function i(){for(var a=r[o],n=e[a],s=wi(n),d=function e(){var r=s[c],i=n[r];t[fe](wd(a,r,()=>xd(i,a,r)))},c=0;c<s[ve];c++)d()},o=0;o<r[ve];o++)i();return t},xd=(e,t,o)=>(ao(ar('Onsite Message(s) Triggered, type: ',t,', attribute: ',o,', message(s): ',e[Te](', '),'.')),kd(e)[ue](e=>{var[o,a,n]=e,s=a['deviceId'];return Ia(e,(e,t)=>An(s)[ue](r=>(r['onsiteABContentIds']||(r['onsiteABContentIds']={}),r['onsiteABContentIds'][e]=t,Rn(r['deviceId'],r))))[ue](e=>{var o=a['contactKey'],d=a['onsiteMessageHistories'],c=n['sessionId'],l=0,u=()=>{if(!(l>=e[ve])){var n=e[l],p=n['publicId'],m=n['isRealtime'],g=!!n['inlineTarget'];d[p]||(d[p]=[]);var v=d[p][ve],f=0;return Oa(n,a,{['onClick']:e=>(ao(ar('Onsite message(',p,') clicked. clickId: ',e),['onsite']),An(s)[ue](t=>{var i=t['contactKey'];return m?Ta(n,'CL',c,s,i,e):Da(n,'setAsClicked',s,i,e),t['onsiteMessageHistories'][p][v]['isClicked']=r,Rn(s,t)})),['onClose']:()=>{t==='ON_SCROLL'&&(bo['isScrollListenerBlocked']=i)},['onStoryVisit']:(e,t)=>An(s)[ue](e=>(e['storySetVisits'][p]=t,Rn(s,e))),['onSubDisplay']:e=>(ao(ar('Onsite Story(',p,') sub-displayed: ',ar('cover: ',e['stPrId'],'(',e['stPrName'],')','story: ',e['stId'],'(',e['stName'],')')),['onsite','story']),An(s)[ue](t=>{var r=t['contactKey'];m?Ta(n,'DS',c,s,r,e):Da(n,'setAsDisplayed',s,r,e);var o=t['onsiteMessageHistories'][p][v];return o['subDisplays']||(o['subDisplays']=[]),o['subDisplays'][fe]({['displayTime']:hi(),['isClicked']:i,['cover']:{[Oe]:e['stPrId'],[Ee]:e['stPrName']},['story']:{[Oe]:e['stId'],[Ee]:e['stName']}}),f=o['subDisplays'][ve]-1,Rn(s,t)})),['onSubClick']:e=>(ao(ar('Onsite message(',p,') clicked. clickId: ',ar('cover: ',e['stPrId'],'(',e['stPrName'],')','story: ',e['stId'],'(',e['stName'],')')),['onsite','story']),An(s)[ue](t=>{var i=t['contactKey'];m?Ta(n,'CL',c,s,i,e):Da(n,'setAsClicked',s,i,e);var o=t['onsiteMessageHistories'][p][v];return o['isClicked']=r,o['subDisplays'][f]['isClicked']=r,Rn(s,t)})),['onSubmitForm']:e=>(ao(ar('Onsite message(',p,') form submitted'),['onsite']),An(s)[ue](t=>{var r=t['contactKey'];return t['contactKey']=r||'sf_'+Ja(),e['source']='subscription_form',ps(t,e)[ue](()=>Rn(s,t))})),['onSubmitTags']:e=>(ao(ar('Onsite message(',p,') tags submitted'),['onsite']),An(s)[ue](t=>ms(e,t['contactKey']?'contact':'contact_or_device')))})[ue](e=>An(a['deviceId'])[ue](e=>{g?t==='ON_SCROLL'&&(bo['isScrollListenerBlocked']=i):e['lastOnsitePopupDisplayTime']=U(e['lastOnsitePopupDisplayTime'],hi()),m?Ta(n,'DS',c,s,o):Da(n,'setAsDisplayed',s,o),e['onsiteMessageHistories'][p]||(e['onsiteMessageHistories'][p]=[]);var r=e['onsiteMessageHistories'][p];return r[fe]({['displayTime']:hi(),['isClicked']:i}),v=r[ve]-1,Rn(s,e)}))[pe](e=>{t==='ON_SCROLL'&&(bo['nextScrollBreakPointIndex']=U(0,bo['nextScrollBreakPointIndex']-1),bo['isScrollListenerBlocked']=i)})[ue](()=>(l++,u()))}};return u()})})),Dd=t=>{var r=Ss();r['deviceId']=t;var i=e;return Kn()[ue](t=>t?(i=t,Ns(r,t)?(ao('Active session parameters are same with the current',['session']),t):(ao('Active session parameters are not same with the current. Searching sessions with current parameters',['session']),Wn(r))):(ao('No active session',['session']),e))[ue](e=>e&&e['endTime']>hi()?(ao('Extending active session',['session']),Cs(e)):(ao('Starting new session',['session']),Od(r,i)))[ue](e=>{var t=e['sessionId'];return e['pageViewCount']=pr(e['pageViewCount']||0)+1,x[le]([Bn(t,e),Tn(t)])[ue](r=>(ao(ar('Session data is stored, active session id(',t,') is set'),['session']),e))})},Od=(e,t)=>{var i=Is(e,e['deviceId']),o=[()=>ks(i)];return t||(i['isFirst']=r),t&&!t['isFirst']&&o[fe](()=>zn(t['sessionId'])),x[le](o[ye](e=>e()))[ue](()=>i)},Ed={['addToCart']:'add_to_cart',['removeFromCart']:'remove_from_cart',['deleteCart']:'delete_cart',['beginCheckout']:'begin_checkout',['order']:'order',['cancelOrder']:'cancel',['addToWishlist']:'add',['removeFromWishlist']:'remove'},Ad=(i,o)=>{try{function u(t,i,o){var a=or(arguments,3);return ao(ar('"',o,'" public action called'),['publicAction',o]),['initialize','setDeviceId'][Ne](o)||bo['isInitialized']?x[de](i['apply'](e,a))[ue](e=>(ao(ar('"',o,'" public action completed'),['publicAction',o]),e))[pe](t=>(xs(ar('"',o,'" has an error: ',t),['publicAction',o],'warn',{['path']:ar('public-action-error/',o),['queryParams']:{['data']:dr(a),['error']:dr(t)}},r),e))[ue](e=>(ir(t)&&t(e),e)):(ao('"'+o+'" puclic action aborted: Action is called before "initialize" is complete',['publicAction',o],'warn'),ir(t)&&t(e),x[de](e))}var n=(e,t)=>u(t,ns,'pageViewAction',e),s=(t,r,i)=>{if(i==='viewCart')return x[de](e);var o=Ii(r);o['event_id']=Ja(),o['event_type']=Ed[i],xi(o,'cartItems');var a=r['cartItems'],n=tr(a)&&a[ve]>0,s=[];return i==='beginCheckout'?s[fe]({['tag']:'last_begin_checkout_date',['value']:fi()}):s[fe]({['tag']:'cart_update_date',['value']:i==='addToCart'||i==='removeFromCart'&&n?fi():''}),['addToCart','removeFromCart'][Ne](i)&&n&&s[fe]({['tag']:'cart_product_list',['value']:a[we]((e,t,r)=>e+t['product_id']+(r!=a[ve]-1?',':''),'')}),i==='deleteCart'&&s[fe]({['tag']:'cart_product_list',['value']:''}),u(t,()=>x[le]([os('shopping_cart_events',o),ms(s,'contact')]),'ec:'+i)},d=(e,t,r)=>{var i=Ii(t),o=i['cartItems'],a=tr(o),n=[];if(a)for(var s=function e(){var t=o[d];t['order_id']=i['order_id'],t['payment_method']=i['payment_method'],t['event_type']=Ed[r],n[fe](()=>os('order_events_detail',t))},d=0;d<o[ve];d++)s();return i['event_type']=Ed[r],r==='cancelOrder'&&(i['total_amount']=-i['total_amount']),xi(i,'cartItems'),u(e,()=>x[le]([os('order_events',i),ms([{['tag']:'cart_update_date',['value']:''},{['tag']:'cart_product_list',['value']:''},{['tag']:'last_order_date',['value']:fi()}],'contact')][he](n[ye](e=>e()))),'ec:'+r)},c=(e,t,r)=>{var i=Ii(t);return i['event_id']=Ja(),i['event_type']=Ed[r],i['list_name']=i['list_name']||'favorites',xi(i,'items'),u(e,os,'ec:'+r,'wishlist_events',i)};a[o]={['getDeviceId']:e=>u(e,Sn,'getDeviceId'),['setDeviceId']:(e,i)=>u(i,()=>yt?ss(e):bo['isInitialized']?(ao('"setDeviceId" is deprecated, "initialize" called with passed "deviceId" value',['setDeviceId','initialize','deprecate'],'warn',t,r),x[de](r)):Id({['deviceId']:e}),'setDeviceId'),['getContactKey']:e=>u(e,In,'getContactKey'),['setContactKey']:(e,r)=>u(r,e=>ss(t,e)[ue](e=>ps(e)),'setContactKey',e),['getCountry']:e=>u(e,()=>cs('country'),'getCountry'),['setCountry']:(e,t)=>u(t,e=>ls('country',e),'setCountry',e),['getUserPermission']:e=>u(e,()=>cs('userPermission'),'getUserPermission'),['setUserPermission']:(e,t)=>u(t,e=>ls('userPermission',e),'setUserPermission',e),['getTrackingPermission']:e=>u(e,()=>cs('trackingPermission'),'getTrackingPermission'),['setTrackingPermission']:(e,t)=>u(t,e=>ls('trackingPermission',e),'setTrackingPermission',e),['isPushNotificationsSupported']:e=>u(e,ld,'isPushNotificationsSupported'),['showNativePrompt']:(t,r)=>u(r,()=>Nt?Ln()[ue](e=>vd(e,t))[ue](e=>x[le]([Rn(e['deviceId'],e),ps(e)])[ue](()=>({['response']:e['pushNotificationPermissionPrompts']['lastCustomPromptResponse'],['permission']:e['pushNotificationPermissionPrompts']['lastNativePromptResponse'],['subscription']:e['pushNotificationSubscription']}))):(ao('"showNativePrompt" public action aborted: Push is not enabled',['pushNotification'],'warn'),x[de](e)),'showNativePrompt'),['showCustomPrompt']:t=>u(t,()=>Nt?Ln()[ue](e=>gd(e))[ue](e=>x[le]([Rn(e['deviceId'],e),ps(e)])[ue](()=>({['response']:e['pushNotificationPermissionPrompts']['lastCustomPromptResponse'],['permission']:e['pushNotificationPermissionPrompts']['lastNativePromptResponse'],['subscription']:e['pushNotificationSubscription']}))):(ao('"showCustomPrompt" public action aborted: Push is not enabled',['pushNotification'],'warn'),x[de](e)),'showCustomPrompt'),['getNotificationPermission']:e=>u(e,ud,'getNotificationPermission'),['getToken']:e=>u(e,()=>cs('pushNotificationSubscription')[ue](e=>e['token']),'getToken'),['pageView']:n,['setNavigation']:(e,t)=>u(t,Sd,'setNavigation',e),['sendDeviceEvent']:(e,t,r)=>u(r,os,'sendDeviceEvent',e,t),['sendCustomEvent']:(e,t,r,i)=>u(i,as,'sendCustomEvent',e,t,r),['setTags']:(e,t)=>u(t,ms,'setTags',e),['setLogLevel']:(e,t)=>u(t,oo,'setLogLevel',e),['initialize']:(e,t)=>u(t,Id,'initialize',e),['ec:pageView']:n,['ec:addToCart']:(e,t)=>s(t,e,'addToCart'),['ec:removeFromCart']:(e,t)=>s(t,e,'removeFromCart'),['ec:viewCart']:(e,t)=>s(t,e,'viewCart'),['ec:deleteCart']:(e,t)=>s(t,e,'deleteCart'),['ec:beginCheckout']:(e,t)=>s(t,e,'beginCheckout'),['ec:order']:(e,t)=>d(t,e,'order'),['ec:cancelOrder']:(e,t)=>d(t,e,'cancelOrder'),['ec:search']:(e,t)=>u(t,os,'search','search_events',e),['ec:addToWishlist']:(e,t)=>c(t,e,'addToWishlist'),['ec:removeFromWishlist']:(e,t)=>c(t,e,'removeFromWishlist')};var l=a[i]&&a[i]['q']||[];return a[i]=function(t){var r=()=>x[de](e),i=or(arguments,1);return a[o][t]&&(r=()=>a[o][t]['apply'](e,i)),a[br]['customFunctions']['custom:'+t]&&(r=()=>a[br]['customFunctions']['custom:'+t]['apply'](e,i)),a[br]['actionQueue'][Ue](r)},l}catch(p){throw p}},Ld=t=>t[0]==='initialize'&&t[1]!=e?1:t[0]==='setDeviceId'?2:t[0]==='initialize'?3:4,Rd=(t,r)=>{r=[][he](r['sort']((e,t)=>Ld(e)-Ld(t)));for(var i=x[de](),o=function o(){var s=r[n];i=i[ue](()=>a[t]['apply'](e,s))},n=0;n<r[ve];n++)o();return i},Fd=()=>{a[Pr]=a[Pr]||[];var e=a[Pr];a['defaultDengageLegacyQueuePush']||(a['defaultDengageLegacyQueuePush']=e[fe]),a[Pr][fe]=function(){for(var e=or(arguments),t=0;t<e[ve];t++)a[br]['actionQueue'][Ue](e[t]);return a['defaultDengageLegacyQueuePush']['apply'](a[Pr],e)};for(var t=x[de](),r=function r(i){t=t[ue](()=>a[br]['actionQueue'][Ue](e[i]))},i=0;i<e[ve];i++)r(i);return t},Md=()=>bo['isInstalled']?(ao('SDK installing cancelled, since SDK already installed',['install'],'warn'),x[de]()):(ao(ar('SDK installed, version: ',rt),['install']),_o(br)[ue](e=>(ao(ar('Global object declared with "',br,'"'),['install']),xn()))[ue](e=>e?(ao('V1 SDK storage is already migrated',['install','storage','migration']),r):(ao('V1 SDK storage is not migrated',['install','storage','migration']),Hs()))[ue](e=>{if(Zt){ao('Custom JS code is defined, executing',['install','customJs']);var t=k(Zt);bo['customJs']={['code']:t,['isExecuted']:i,['error']:ie};try{bo['customJs']['isExecuted']=r,t(),ao('Custom JS code is executed succesfully',['install','customJs'])}catch(e){bo['customJs']['error']=e,ao(ar('Custom JS code execution error: ',e),['install','customJs'],'warn')}finally{return}}else ao('Custom JS code is not defined',['install','customJs'])})[ue](()=>Nt?x[le]([Jn('recieveTime',ci,di)[ue](e=>{ao(ar('Old and excess Push Messages, deleted: ',e['deleteCount'],', remaining: ',e['recordCount']),['install','storage','pushMessages'])}),Zn('createTime',ui,li)[ue](e=>{ao(ar('Old and excess Service Worker Logs, deleted: ',e['deleteCount'],', remaining: ',e['recordCount']),['install','storage','serviceWorkerLogs'])})]):e)[ue](()=>bo['script']['parameters']['init']||Pt?a['dengage']('initialize'):e)[ue](()=>Ad(_r,wr))[ue](e=>(ao('Public actions declared',['install']),bo['isInstalled']=r,ao(ar('Handling of actions called before install started. Action count: ',e[ve]),['install']),Rd(_r,e)))[ue](()=>(ao(ar('Handling of actions called before install completed.'),['install']),Fd()))[ue](()=>(ao(ar('Handling of actions called on dnQueue completed.'),['install']),r))[pe](e=>{xs(ar('SDK install error: ',e),['install'],'error',{['path']:'install-error',['queryParams']:{['error']:dr(e)}},r)}));x[le]([vn(),gn(),fn()])[ue](e=>{var t=e[0],i=e[1],o=e[2];if(!ht||o)if(t||i)try{Ha()[ue](e=>{e||Md()})}catch(e){xs('Pre-install error:'+e,['preInstall'],'error',{['path']:'preinstall-error',['queryParams']:{['error']:jsonStringify(e)}},r)}else ao('SDK install aborted: "indexedDb" and "localStorage", both are not accesible',['requirements'],'warn');else ao('SDK install aborted: "Data Sync Between Domains" feature is enabled, but "cookie" is not accesible',['requirements'],'warn')})[pe](e=>{ao('Requirements error:'+e,['requirements'],'error')})})();
